(()=>{"use strict";var t={632:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ai=void 0;const s=i(882);e.ai=class{canvas;canvas_width;canvas_height;ctx;game;state_check=!1;constructor(t){this.canvas=t.canvas,this.canvas_width=this.canvas.width,this.canvas_height=this.canvas.height,this.ctx=this.canvas.getContext("2d"),this.game=t.game}start(){this.state_check=!0,this.check()}pause(){this.state_check=!1}check(){if(this.state_check){if(!this.is_attack_enemy){this.ctx.clearRect(0,0,this.canvas_width,this.canvas_height),this.detect_player();const t=this.detect_enemy(this.get_near_distance());t&&this.attack_enemy(this.game.player,t),this.detect_state()}requestIdleCallback((()=>{this.check()}))}}is_detect_state=!1;detect_state(){this.is_detect_state||(this.is_detect_state=!0,this.game.game_over||this.game.game_up||this.game.game_ready||this.game.game_pause?this.press_key("Enter",100,(()=>{this.is_detect_state=!1})):(("idle"===this.game.player.current_state?.current_state||"sit"===this.game.player.current_state?.current_state&&this.game.player.power>=100&&!this.is_attack_enemy)&&this.press_key("ArrowRight"),this.is_detect_state=!1))}detect_player(){this.game.debug&&(this.ctx.save(),this.ctx.fillStyle="green",this.ctx.beginPath(),this.ctx.arc(this.game.player.x+.5*this.game.player.width,this.game.player.y+.5*this.game.player.height,.5*this.game.player.width,0,s.MathPI2),this.ctx.fill(),this.ctx.restore())}calc_distance(t,e){const i=e.collision_x-t.collision_x,s=e.collision_y-t.collision_y;return Math.sqrt(i*i+s*s)}detect_enemy(t){let e=null,i=Number.MAX_VALUE;if(this.game.enemy_list.forEach((s=>{const a=this.calc_distance(this.game.player,s);a<s.width*s.collision_scale+this.game.player.width*this.game.player.collision_scale+t&&a<i&&(e=s,i=a)})),this.game.debug&&null!==e){let t=e;this.ctx.save(),this.ctx.fillStyle="red",this.ctx.beginPath(),this.ctx.arc(t.x+.5*t.width,t.y+.5*t.height,.5*t.width,0,s.MathPI2),this.ctx.fill(),this.ctx.restore()}return e}get_near_distance(){return 150}is_enemy_near(t,e){return this.calc_distance(t,e)<e.width*e.collision_scale+t.width*t.collision_scale+this.get_near_distance()}is_enemy_top(t,e){return e.x+e.height<=t.x}is_attack_enemy=!1;attack_enemy(t,e){this.is_attack_enemy||(this.is_attack_enemy=!0,t.power>20?this.is_enemy_top(t,e)?(this.game.debug&&console.log("top"),t.life>50?this.press_key("ArrowUp",500,(()=>{this.press_key("ArrowDown",300,(()=>{this.is_attack_enemy=!1}))})):this.is_attack_enemy=!1):(this.game.debug&&console.log("front"),this.press_key("Control",100,(()=>{this.is_attack_enemy=!1}))):this.press_key("ArrowDown",3e3,(()=>{this.press_key("ArrowRight",100,(()=>{this.is_attack_enemy=!1}))})))}press_key(t,e,i){e??=100,window.dispatchEvent(new KeyboardEvent("keydown",{key:t})),setTimeout((()=>{this.release_key(t),i&&i()}),e)}release_key(t){window.dispatchEvent(new KeyboardEvent("keyup",{key:t}))}}},556:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LOAD_ALL_ASSET=e.ASSETSOUND=e.ASSETIMG=e.ASSETSVG=e.ASSET_SIZE=e.ASSET=e.BTN_MARGIN=e.BTN_PADDING=e.BTN_SIZE=e.BTN_COLOR=e.COLOR=void 0;const i=window.devicePixelRatio;e.COLOR={red:"255,36,0",yellow:"255,215,0",green:"42, 170, 138",blue:"0, 150, 255",light:"255, 255, 255",medium:"125, 125, 125",dark:"50, 50, 50"},e.BTN_COLOR={normal:`rgba(${e.COLOR.light}, 0.5)`,normal_icon:`rgba(${e.COLOR.light}, 1)`,click:`rgba(${e.COLOR.blue}, 0.5)`,click_icon:`rgba(${e.COLOR.blue}, 1)`},e.BTN_SIZE=35*i,e.BTN_PADDING=20*i,e.BTN_MARGIN=30,e.ASSET={bg1:{layer1:"./res/bg1/layer-1.png",layer2:"./res/bg1/layer-2.png",layer3:"./res/bg1/layer-3.png",layer4:"./res/bg1/layer-4.png",layer5:"./res/bg1/layer-5.png"},bg2:{layer1:"./res/bg2/layer-1.png",layer2:"./res/bg2/layer-2.png",layer3:"./res/bg2/layer-3.png",layer4:"./res/bg2/layer-4.png",layer5:"./res/bg2/layer-5.png"},ctl:{action:"./res/ctl/action.svg",down:"./res/ctl/down.svg",full_screen:"./res/ctl/full_screen.svg",icon:"./res/ctl/icon.svg",icon_png:"./res/ctl/icon.png",info:"./res/ctl/info.svg",left:"./res/ctl/left.svg",life_icon_inactive:"./res/ctl/life_icon_inactive.svg",life_icon:"./res/ctl/life_icon.svg",life_icon_inactive_png:"./res/ctl/life_icon_inactive.png",life_icon_png:"./res/ctl/life_icon.png",normal_screen:"./res/ctl/normal_screen.svg",pause:"./res/ctl/pause.svg",power_icon_inactive:"./res/ctl/power_icon_inactive.svg",power_icon:"./res/ctl/power_icon.svg",power_icon_inactive_png:"./res/ctl/power_icon_inactive.png",power_icon_png:"./res/ctl/power_icon.png",power1:"./res/ctl/power1.svg",power2:"./res/ctl/power2.svg",right:"./res/ctl/right.svg",shield_icon_inactive:"./res/ctl/shield_icon_inactive.svg",shield_icon:"./res/ctl/shield_icon.svg",shield_icon_inactive_png:"./res/ctl/shield_icon_inactive.png",shield_icon_png:"./res/ctl/shield_icon.png",start:"./res/ctl/start.svg",stopwatch_icon_inactive:"./res/ctl/stopwatch_icon_inactive.svg",stopwatch_icon:"./res/ctl/stopwatch_icon.svg",stopwatch_icon_inactive_png:"./res/ctl/stopwatch_icon_inactive.png",stopwatch_icon_png:"./res/ctl/stopwatch_icon.png",up:"./res/ctl/up.svg"},enemy:{enemy1:"./res/enemy/enemy1.png",enemy2:"./res/enemy/enemy2.png",enemy3:"./res/enemy/enemy3.png",enemy4:"./res/enemy/enemy4.png",enemy5:"./res/enemy/enemy5.png",enemy6:"./res/enemy/enemy6.png",enemy7:"./res/enemy/enemy7.png",enemy8:"./res/enemy/enemy8.png",enemy9:"./res/enemy/enemy9.png",enemy10:"./res/enemy/enemy10.png",enemy11:"./res/enemy/enemy11.png"},font:{Creepster_eot:"./res/font/Creepster.eot",Creepster_svg:"./res/font/Creepster.svg",Creepster_ttf:"./res/font/Creepster.ttf",Creepster_woff:"./res/font/Creepster.woff",Creepster_woff2:"./res/font/Creepster.woff2"},boom:"./res/boom.png",boom_wav:"./res/boom.wav",fire:"./res/fire.png",shadow:"./res/shadow.png",player:"./res/player.png",svg:{down:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>\n</svg>',full_screen:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M1.5 1a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4A1.5 1.5 0 0 1 1.5 0h4a.5.5 0 0 1 0 1h-4zM10 .5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 16 1.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zM.5 10a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 0 14.5v-4a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v4a1.5 1.5 0 0 1-1.5 1.5h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5z"/>\n</svg>',trophy:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5zm.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935z"/>\n</svg>',info:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>\n  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>\n</svg>',left:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>\n</svg>',life:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M1.475 9C2.702 10.84 4.779 12.871 8 15c3.221-2.129 5.298-4.16 6.525-6H12a.5.5 0 0 1-.464-.314l-1.457-3.642-1.598 5.593a.5.5 0 0 1-.945.049L5.889 6.568l-1.473 2.21A.5.5 0 0 1 4 9H1.475Z"/>\n  <path d="M.88 8C-2.427 1.68 4.41-2 7.823 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C11.59-2 18.426 1.68 15.12 8h-2.783l-1.874-4.686a.5.5 0 0 0-.945.049L7.921 8.956 6.464 5.314a.5.5 0 0 0-.88-.091L3.732 8H.88Z"/>\n</svg>',normal_screen:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M5.5 0a.5.5 0 0 1 .5.5v4A1.5 1.5 0 0 1 4.5 6h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5zm5 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 10 4.5v-4a.5.5 0 0 1 .5-.5zM0 10.5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 6 11.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zm10 1a1.5 1.5 0 0 1 1.5-1.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4z"/>\n</svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z"/>\n</svg>',record:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 13A5 5 0 1 0 8 3a5 5 0 0 0 0 10z"/>\n</svg>',lightning:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/>\n</svg>',right:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>\n</svg>',shield:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"/>\n</svg>',start:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>\n</svg>',stopwatch:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path d="M6.5 0a.5.5 0 0 0 0 1H7v1.07A7.001 7.001 0 0 0 8 16a7 7 0 0 0 5.29-11.584.531.531 0 0 0 .013-.012l.354-.354.353.354a.5.5 0 1 0 .707-.707l-1.414-1.415a.5.5 0 1 0-.707.707l.354.354-.354.354a.717.717 0 0 0-.012.012A6.973 6.973 0 0 0 9 2.071V1h.5a.5.5 0 0 0 0-1h-3zm2 5.6V9a.5.5 0 0 1-.5.5H4.5a.5.5 0 0 1 0-1h3V5.6a.5.5 0 1 1 1 0z"/>\n</svg>',up:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>\n</svg>'}},e.ASSET_SIZE={bg1:{layer1:88900,layer2:89900,layer3:112e3,layer4:102e3,layer5:18e3},bg2:{layer1:19300,layer2:42300,layer3:63200,layer4:55500,layer5:95800},ctl:{action:246,down:286,full_screen:519,icon:604,icon_png:984,info:451,left:288,life_icon_inactive:538,life_icon:538,life_icon_inactive_png:5060,life_icon_png:791,normal_screen:518,pause:243,power_icon_inactive:277,power_icon:277,power_icon_inactive_png:4950,power_icon_png:753,power1:182,power2:277,right:288,shield_icon_inactive:521,shield_icon:521,shield_icon_inactive_png:5350,shield_icon_png:1040,stopwatch_icon_inactive:453,stopwatch_icon:453,stopwatch_icon_inactive_png:5590,stopwatch_icon_png:978,up:288},enemy:{enemy1:65500,enemy2:67600,enemy3:35100,enemy4:61200,enemy5:35600,enemy6:65600,enemy7:54400,enemy8:77600,enemy9:17300,enemy10:29200,enemy11:13500},font:{Creepster_eot:61400,Creepster_svg:25e4,Creepster_ttf:59900,Creepster_woff:33900,Creepster_woff2:29100},boom:72200,boom_wav:318e3,fire:38200,shadow:7800,player:176e4,svg:{down:286,full_screen:519,trophy:604,info:452,left:288,life:539,normal_screen:518,pause:243,record:182,lightning:277,right:288,shield:521,start:251,stopwatch:453,up:288}};const s={},a=(t,e,i,h)=>{e<t.length?(i(0,t[e].name,t[e].size),((t,e,i)=>{const a=`url_${e.replace(/[\W_]+/g,"_")}`;a in s?i():new FontFace(t,`url(${e})`).load().then((t=>{s[a]=t,document.fonts.add(t),i()}))})(t[e].name,t[e].url,(()=>{i(t[e].size),a(t,e+1,i,h)}))):h()},h={},r=(t,e,i,s)=>{e<t.length?(i(0,t[e].name,t[e].size),((t,e)=>{const i=`url_${t.replace(/[\W_]+/g,"_")}`;if(i in h)e();else{const s=new Audio;s.src=t,h[i]=s,e()}})(t[e].url,(()=>{i(t[e].size),r(t,e+1,i,s)}))):s()},n={},_=(t,e,i,s)=>{e<t.length?(i(0,t[e].name,t[e].size),((t,e)=>{const i=`url_${t.replace(/[\W_]+/g,"_")}`;if(i in n)e();else{const s=new Image;s.onload=t=>{const s=t.target;n[i]=s,e()},s.src=t}})(t[e].url,(()=>{i(t[e].size),_(t,e+1,i,s)}))):s()},o={},l=(t,e,i,s)=>{e<t.length?(i(0,t[e].name,t[e].size),((t,e,i)=>{const s=t.replace(/fill\=\"currentColor\"/g,`fill="${e}"`),a=`data:image/svg+xml,${encodeURIComponent(s)}`,h=a.replace(/[\W_]+/g,"_");if(h in o)i();else{const t=new Image;t.onload=t=>{const e=t.target;o[h]=e,i()},t.src=a}})(t[e].url,t[e].color,(()=>{i(t[e].size),l(t,e+1,i,s)}))):s()};e.ASSETSVG=(t,i)=>{const s=e.ASSET.svg[t].replace(/fill\=\"currentColor\"/g,`fill="${i}"`),a=`data:image/svg+xml,${encodeURIComponent(s)}`,h=a.replace(/[\W_]+/g,"_");if(h in o){const t=o[h];if(t)return t;{console.warn("svg asset not loaded",s);const t=new Image;return t.src=a,o[h]=t,t}}{console.warn("svg asset not loaded",s);const t=new Image;return t.src=a,o[h]=t,t}};e.ASSETIMG=t=>{const e=`url_${t.replace(/[\W_]+/g,"_")}`;if(e in n){const i=n[e];if(i)return i;{console.warn("img asset not loaded",t);const i=new Image;return i.src=t,n[e]=i,i}}{console.warn("img asset not loaded",t);const i=new Image;return i.src=t,n[e]=i,i}};e.ASSETSOUND=t=>{const e=`url_${t.replace(/[\W_]+/g,"_")}`;if(e in h){const i=h[e];if(i)return i;{console.warn("sound asset not loaded",t);const i=new Audio;return i.src=t,h[e]=i,i}}{console.warn("sound asset not loaded",t);const i=new Audio;return i.src=t,h[e]=i,i}};e.LOAD_ALL_ASSET=(t,i)=>{((t,i)=>{a([{name:"Creepster",url:e.ASSET.font.Creepster_woff2,size:e.ASSET_SIZE.font.Creepster_woff2}],0,t,i)})(t,(()=>{((t,i)=>{_([{name:"ASSET.player",url:e.ASSET.player,size:e.ASSET_SIZE.player},{name:"ASSET.boom",url:e.ASSET.boom,size:e.ASSET_SIZE.boom},{name:"ASSET.fire",url:e.ASSET.fire,size:e.ASSET_SIZE.fire},{name:"ASSET.shadow",url:e.ASSET.shadow,size:e.ASSET_SIZE.shadow},{name:"ASSET.bg1.layer1",url:e.ASSET.bg1.layer1,size:e.ASSET_SIZE.bg1.layer1},{name:"ASSET.bg1.layer2",url:e.ASSET.bg1.layer2,size:e.ASSET_SIZE.bg1.layer2},{name:"ASSET.bg1.layer3",url:e.ASSET.bg1.layer3,size:e.ASSET_SIZE.bg1.layer3},{name:"ASSET.bg1.layer4",url:e.ASSET.bg1.layer4,size:e.ASSET_SIZE.bg1.layer4},{name:"ASSET.bg1.layer5",url:e.ASSET.bg1.layer5,size:e.ASSET_SIZE.bg1.layer5},{name:"ASSET.bg2.layer1",url:e.ASSET.bg2.layer1,size:e.ASSET_SIZE.bg2.layer1},{name:"ASSET.bg2.layer2",url:e.ASSET.bg2.layer2,size:e.ASSET_SIZE.bg2.layer2},{name:"ASSET.bg2.layer3",url:e.ASSET.bg2.layer3,size:e.ASSET_SIZE.bg2.layer3},{name:"ASSET.bg2.layer4",url:e.ASSET.bg2.layer4,size:e.ASSET_SIZE.bg2.layer4},{name:"ASSET.bg2.layer5",url:e.ASSET.bg2.layer5,size:e.ASSET_SIZE.bg2.layer5},{name:"ASSET.ctl.icon_png",url:e.ASSET.ctl.icon_png,size:e.ASSET_SIZE.ctl.icon_png},{name:"ASSET.ctl.life_icon_png",url:e.ASSET.ctl.life_icon_png,size:e.ASSET_SIZE.ctl.life_icon_png},{name:"ASSET.ctl.power_icon_png",url:e.ASSET.ctl.power_icon_png,size:e.ASSET_SIZE.ctl.power_icon_png},{name:"ASSET.ctl.shield_icon_png",url:e.ASSET.ctl.shield_icon_png,size:e.ASSET_SIZE.ctl.shield_icon_png},{name:"ASSET.ctl.stopwatch_icon_png",url:e.ASSET.ctl.stopwatch_icon_png,size:e.ASSET_SIZE.ctl.stopwatch_icon_png},{name:"ASSET.ctl.life_icon_inactive_png",url:e.ASSET.ctl.life_icon_inactive_png,size:e.ASSET_SIZE.ctl.life_icon_inactive_png},{name:"ASSET.ctl.power_icon_inactive_png",url:e.ASSET.ctl.power_icon_inactive_png,size:e.ASSET_SIZE.ctl.power_icon_inactive_png},{name:"ASSET.ctl.shield_icon_inactive_png",url:e.ASSET.ctl.shield_icon_inactive_png,size:e.ASSET_SIZE.ctl.shield_icon_inactive_png},{name:"ASSET.ctl.stopwatch_icon_inactive_png",url:e.ASSET.ctl.stopwatch_icon_inactive_png,size:e.ASSET_SIZE.ctl.stopwatch_icon_inactive_png},{name:"ASSET.enemy.enemy1",url:e.ASSET.enemy.enemy1,size:e.ASSET_SIZE.enemy.enemy1},{name:"ASSET.enemy.enemy2",url:e.ASSET.enemy.enemy2,size:e.ASSET_SIZE.enemy.enemy2},{name:"ASSET.enemy.enemy3",url:e.ASSET.enemy.enemy3,size:e.ASSET_SIZE.enemy.enemy3},{name:"ASSET.enemy.enemy4",url:e.ASSET.enemy.enemy4,size:e.ASSET_SIZE.enemy.enemy4},{name:"ASSET.enemy.enemy5",url:e.ASSET.enemy.enemy5,size:e.ASSET_SIZE.enemy.enemy5},{name:"ASSET.enemy.enemy6",url:e.ASSET.enemy.enemy6,size:e.ASSET_SIZE.enemy.enemy6},{name:"ASSET.enemy.enemy7",url:e.ASSET.enemy.enemy7,size:e.ASSET_SIZE.enemy.enemy7},{name:"ASSET.enemy.enemy8",url:e.ASSET.enemy.enemy8,size:e.ASSET_SIZE.enemy.enemy8},{name:"ASSET.enemy.enemy9",url:e.ASSET.enemy.enemy9,size:e.ASSET_SIZE.enemy.enemy9},{name:"ASSET.enemy.enemy10",url:e.ASSET.enemy.enemy10,size:e.ASSET_SIZE.enemy.enemy10},{name:"ASSET.enemy.enemy11",url:e.ASSET.enemy.enemy11,size:e.ASSET_SIZE.enemy.enemy11}],0,t,i)})(t,(()=>{((t,i)=>{r([{name:"ASSET.boom_wav",url:e.ASSET.boom_wav,size:e.ASSET_SIZE.boom_wav}],0,t,i)})(t,(()=>{((t,i)=>{l([{name:"ASSET.svg.right (normal)",url:e.ASSET.svg.right,size:e.ASSET_SIZE.svg.right,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.down (normal)",url:e.ASSET.svg.down,size:e.ASSET_SIZE.svg.down,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.left (normal)",url:e.ASSET.svg.left,size:e.ASSET_SIZE.svg.left,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.up (normal)",url:e.ASSET.svg.up,size:e.ASSET_SIZE.svg.up,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.full_screen (normal)",url:e.ASSET.svg.full_screen,size:e.ASSET_SIZE.svg.full_screen,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.normal_screen (normal)",url:e.ASSET.svg.normal_screen,size:e.ASSET_SIZE.svg.normal_screen,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.lightning (normal)",url:e.ASSET.svg.lightning,size:e.ASSET_SIZE.svg.lightning,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.record (normal)",url:e.ASSET.svg.record,size:e.ASSET_SIZE.svg.record,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.pause (normal)",url:e.ASSET.svg.pause,size:e.ASSET_SIZE.svg.pause,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.start (normal)",url:e.ASSET.svg.start,size:e.ASSET_SIZE.svg.start,color:e.BTN_COLOR.normal_icon},{name:"ASSET.svg.right (click)",url:e.ASSET.svg.right,size:e.ASSET_SIZE.svg.right,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.down (click)",url:e.ASSET.svg.down,size:e.ASSET_SIZE.svg.down,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.left (click)",url:e.ASSET.svg.left,size:e.ASSET_SIZE.svg.left,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.up (click)",url:e.ASSET.svg.up,size:e.ASSET_SIZE.svg.up,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.full_screen (click)",url:e.ASSET.svg.full_screen,size:e.ASSET_SIZE.svg.full_screen,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.normal_screen (click)",url:e.ASSET.svg.normal_screen,size:e.ASSET_SIZE.svg.normal_screen,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.lightning (click)",url:e.ASSET.svg.lightning,size:e.ASSET_SIZE.svg.lightning,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.record (click)",url:e.ASSET.svg.record,size:e.ASSET_SIZE.svg.record,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.pause (click)",url:e.ASSET.svg.pause,size:e.ASSET_SIZE.svg.pause,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.start (click)",url:e.ASSET.svg.start,size:e.ASSET_SIZE.svg.start,color:e.BTN_COLOR.click_icon},{name:"ASSET.svg.life (color)",url:e.ASSET.svg.life,size:e.ASSET_SIZE.svg.life,color:`rgb(${e.COLOR.red})`},{name:"ASSET.svg.lightning (color)",url:e.ASSET.svg.lightning,size:e.ASSET_SIZE.svg.lightning,color:`rgb(${e.COLOR.yellow})`},{name:"ASSET.svg.stopwatch (color)",url:e.ASSET.svg.stopwatch,size:e.ASSET_SIZE.svg.stopwatch,color:`rgb(${e.COLOR.blue})`},{name:"ASSET.svg.shield (color)",url:e.ASSET.svg.shield,size:e.ASSET_SIZE.svg.shield,color:`rgb(${e.COLOR.green})`},{name:"ASSET.svg.life (light)",url:e.ASSET.svg.life,size:e.ASSET_SIZE.svg.life,color:`rgb(${e.COLOR.light})`},{name:"ASSET.svg.lightning (light)",url:e.ASSET.svg.lightning,size:e.ASSET_SIZE.svg.lightning,color:`rgb(${e.COLOR.light})`},{name:"ASSET.svg.stopwatch (light)",url:e.ASSET.svg.stopwatch,size:e.ASSET_SIZE.svg.stopwatch,color:`rgb(${e.COLOR.light})`},{name:"ASSET.svg.shield (light)",url:e.ASSET.svg.shield,size:e.ASSET_SIZE.svg.shield,color:`rgb(${e.COLOR.light})`}],0,t,i)})(t,(()=>{i()}))}))}))}))}},877:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.baseAnimation=void 0;const s=i(882);e.baseAnimation=class{ctx;fps;frame_x;frame_timer;frame_interval;frame_y;mark_delete;img;x;y;width;height;sprite_width;sprite_height;sprite_length;animation_repeat;animation_repeat_index;can_change_size;constructor(t){t.fps??=24,t.animation_repeat??=0,t.can_change_size??=!1,this.ctx=t.ctx,this.fps=t.fps,this.frame_timer=0,this.frame_interval=1e3/this.fps,this.frame_x=0,this.frame_y=0,this.mark_delete=!1,this.img=t.img,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.sprite_length=t.sprite_length,this.sprite_width=t.sprite_width,this.sprite_height=t.sprite_height,this.can_change_size=t.can_change_size,this.animation_repeat=t.animation_repeat,this.animation_repeat_index=0,this.build_sprite()}update(t){this.frame_timer>=this.frame_interval?(this.frame_timer=0,this.frame_x>=this.sprite_length-1?0===this.animation_repeat?this.frame_x=0:this.animation_repeat>0&&(this.animation_repeat_index++,this.animation_repeat_index>=this.animation_repeat?t.onframecomplete?t.onframecomplete():this.mark_delete=!0:this.frame_x=0):(this.frame_x++,t.onframechange&&t.onframechange())):this.frame_timer+=t.delta_time}draw(){this.can_change_size?this.ctx.drawImage(this.img,this.frame_x,this.frame_y,this.sprite_width,this.sprite_height,(0,s.MathFloor)(this.x),(0,s.MathFloor)(this.y),this.width,this.height):this.ctx.drawImage(this.img_sprite[this.frame_x],(0,s.MathFloor)(this.x),(0,s.MathFloor)(this.y))}set_position(t){this.x-=t.game_speed,this.x<0-this.width&&(this.mark_delete=!0)}img_sprite=[];build_sprite(){this.img_sprite=[],this.frame_x=0;for(let t=0;t<this.sprite_length;t++){const e=t*this.sprite_width,i=new OffscreenCanvas(this.width,this.height);if(i){const t=i.getContext("2d");t&&(t.drawImage(this.img,e,this.frame_y,this.sprite_width,this.sprite_height,0,0,this.width,this.height),this.img_sprite.push(i.transferToImageBitmap()))}}return this.img_sprite}}},722:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.baseBg=void 0;const s=i(451);e.baseBg=class{ctx;ground;img_width;img_height;canvas_width;canvas_height;support_shadow;bg_list=[];constructor(t){t.support_shadow??=!1,this.ctx=t.ctx,this.img_width=t.img_width,this.img_height=t.img_height,this.ground=t.ground,this.support_shadow=t.support_shadow,this.canvas_width=t.canvas_width,this.canvas_height=t.canvas_height,t.img_list.forEach((t=>{this.bg_list.push(new s.layer({ctx:this.ctx,img:t.img,canvas_height:this.canvas_height,img_width:this.img_width,img_height:this.img_height,speed_modifier:t.speed_modifier}))}))}update=t=>{this.bg_list.forEach((e=>{e.update(t.game_speed)}))};draw=()=>{this.bg_list.forEach((t=>{t.draw()}))}}},971:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.bg1=void 0;const s=i(556),a=i(722);class h extends a.baseBg{constructor(t){super({ctx:t.ctx,img_list:[{img:(0,s.ASSETIMG)(s.ASSET.bg1.layer1),speed_modifier:0},{img:(0,s.ASSETIMG)(s.ASSET.bg1.layer2),speed_modifier:.2},{img:(0,s.ASSETIMG)(s.ASSET.bg1.layer3),speed_modifier:.4},{img:(0,s.ASSETIMG)(s.ASSET.bg1.layer4),speed_modifier:.8},{img:(0,s.ASSETIMG)(s.ASSET.bg1.layer5),speed_modifier:1}],canvas_width:t.canvas_width,canvas_height:t.canvas_height,img_width:2400,img_height:700,ground:700*.14})}}e.bg1=h},205:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.bg2=void 0;const s=i(556),a=i(722);class h extends a.baseBg{constructor(t){super({ctx:t.ctx,img_list:[{img:(0,s.ASSETIMG)(s.ASSET.bg2.layer1),speed_modifier:.2},{img:(0,s.ASSETIMG)(s.ASSET.bg2.layer2),speed_modifier:.4},{img:(0,s.ASSETIMG)(s.ASSET.bg2.layer3),speed_modifier:.6},{img:(0,s.ASSETIMG)(s.ASSET.bg2.layer4),speed_modifier:.8},{img:(0,s.ASSETIMG)(s.ASSET.bg2.layer5),speed_modifier:1}],canvas_width:t.canvas_width,canvas_height:t.canvas_height,img_width:1667,img_height:500,ground:50,support_shadow:!0})}}e.bg2=h},324:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.control=void 0;const s=i(556),a=i(882);class h{debug;wm={};ctx;ctx_mark;name;x;y;uid;uid_text;uid_number;img;img_url;img_width;img_height;color;width;height;padding;line_width;constructor(t){t.width??=s.BTN_SIZE,t.height??=s.BTN_SIZE,t.img_width??=16,t.img_height??=16,t.padding??=.5*s.BTN_PADDING,t.color??=s.BTN_COLOR.normal,t.line_width??=2,t.debug??=!1,this.debug=t.debug,this.ctx=t.ctx,this.ctx_mark=t.ctx_mark,this.uid=(0,a.genUID)(),this.uid_number=`${this.uid[0]},${this.uid[1]},${this.uid[2]}`,this.uid_text=`rgb(${this.uid[0]},${this.uid[1]},${this.uid[2]})`,this.name=t.name,this.img=t.img,this.img_url=this.img.src,this.img_width=t.img_width,this.img_height=t.img_height,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.padding=t.padding,this.color=t.color,this.line_width=t.line_width}clear(){this.draw_clear({ctx:this.ctx})}draw(){this.clear(),this.draw_fill({ctx:this.ctx,color:this.color}),this.draw_line({ctx:this.ctx}),this.draw_img({ctx:this.ctx})}clear_mark(){this.draw_clear({ctx:this.ctx_mark})}draw_mark(){this.clear_mark(),this.draw_fill({ctx:this.ctx_mark,color:this.uid_text})}scale_wm=2;draw_fill(t){const e=`fill_${this.width}_${this.height}_${this.line_width}_${t.color}`;if(void 0===this.wm[e]){const i=this.width+this.line_width*this.scale_wm,s=this.height+this.line_width*this.scale_wm,h=new OffscreenCanvas(i,s),r=h.getContext("2d");r&&(r.save(),r.beginPath(),r.fillStyle=t.color,r.strokeStyle=t.color,r.lineWidth=this.line_width,r.arc(this.line_width+.5*this.width,this.line_width+.5*this.height,.5*this.width,0,a.MathPI2),r.fill(),r.stroke(),r.restore(),this.wm[e]=h.transferToImageBitmap())}void 0!==this.wm[e]&&t.ctx.drawImage(this.wm[e],this.x,this.y)}draw_line(t){const e=`line_${this.width}_${this.height}_${this.line_width}_${this.color}`;if(void 0===this.wm[e]){const t=this.width+this.line_width*this.scale_wm,i=this.height+this.line_width*this.scale_wm,s=new OffscreenCanvas(t,i),h=s.getContext("2d");h&&(h.save(),h.beginPath(),h.strokeStyle=this.color,h.lineWidth=this.line_width,h.arc(this.line_width+.5*this.width,this.line_width+.5*this.height,.5*this.width,0,a.MathPI2),h.stroke(),h.restore(),this.wm[e]=s.transferToImageBitmap())}void 0!==this.wm[e]&&t.ctx.drawImage(this.wm[e],this.x,this.y)}draw_clear(t){const e=`clear_${this.width}_${this.height}_${this.line_width}`;if(void 0===this.wm[e]){const t=this.width+this.line_width*this.scale_wm,i=this.height+this.line_width*this.scale_wm,s=new OffscreenCanvas(t,i),h=s.getContext("2d");h&&(h.save(),h.beginPath(),h.fillStyle="black",h.strokeStyle="black",h.lineWidth=2*this.line_width,h.arc(this.line_width+.5*this.width,this.line_width+.5*this.height,.5*this.width,0,a.MathPI2),h.fill(),h.stroke(),h.restore(),this.wm[e]=s.transferToImageBitmap())}void 0!==this.wm[e]&&(t.ctx.save(),t.ctx.globalCompositeOperation="destination-out",t.ctx.drawImage(this.wm[e],this.x,this.y),t.ctx.restore())}draw_img(t){const e=`img_${this.width}_${this.height}_${this.padding}_${this.img_width}_${this.img_height}_${this.img.src.replace(/[\W_]+/g,"_")}`;if(void 0===this.wm[e]){const t=this.width+this.padding*this.scale_wm,i=this.height+this.padding*this.scale_wm,s=new OffscreenCanvas(t,i),a=s.getContext("2d");a&&(a.drawImage(this.img,0,0,this.img_width,this.img_height,this.padding+this.line_width,this.padding+this.line_width,this.width-2*this.padding,this.height-2*this.padding),this.wm[e]=s.transferToImageBitmap())}void 0!==this.wm[e]&&t.ctx.drawImage(this.wm[e],this.x,this.y)}}class r{debug;wm={};ctx;ctx_mark;name;x;y;uid;uid_text;uid_number;img;img_url;img_width;img_height;width;height;padding;color;line_width;btn_width;hole_width;start_degree;end_degree;constructor(t){t.hole_width??=.5*s.BTN_SIZE,t.btn_width??=.5*s.BTN_SIZE+t.hole_width,t.padding??=.4*t.btn_width,t.color??=s.BTN_COLOR.normal,t.line_width??=2,t.img_width??=16,t.img_height??=16,t.width??=t.btn_width,t.height??=t.btn_width,t.debug??=!1,this.debug=t.debug,this.ctx=t.ctx,this.ctx_mark=t.ctx_mark,this.uid=(0,a.genUID)(),this.uid_number=`${this.uid[0]},${this.uid[1]},${this.uid[2]}`,this.uid_text=`rgb(${this.uid[0]},${this.uid[1]},${this.uid[2]})`,this.name=t.name,this.img=t.img,this.img_url=this.img.src,this.img_width=t.img_width,this.img_height=t.img_height,this.width=t.width,this.height=t.height,this.x=t.x,this.y=t.y,this.hole_width=t.hole_width,this.btn_width=t.btn_width+this.hole_width,this.start_degree=t.start_degree,this.end_degree=t.end_degree,this.color=t.color,this.padding=t.padding,this.line_width=t.line_width}clear(){this.draw_clear({ctx:this.ctx})}draw(){this.clear(),this.draw_fill({ctx:this.ctx,color:this.color}),this.draw_line({ctx:this.ctx}),this.draw_img({ctx:this.ctx})}clear_mark(){this.draw_clear({ctx:this.ctx_mark})}draw_mark(){this.clear_mark(),this.draw_fill({ctx:this.ctx_mark,color:this.uid_text})}calc_middle_degree(t,e){if(t>e){let i=360-t;return.5*(e+i)-i}{let i=.5*((t=(t%360+360)%360)+(e=(e%360+360)%360));return i=(i%360+360)%360,i}}calc_degree(t){return t>360?this.calc_degree(360-t):t<0?this.calc_degree(360+t):360===t?0:t}get_angle_position(t,e,i,s){const h=s*a.MathPI/180;return{x:t+i*Math.cos(h),y:e+i*Math.sin(h)}}angle_degree_for_arc(t){return a.MathPI*(.00555555555*t)}scale_wm=2;draw_fill(t){const e=`fill_${this.hole_width}_${this.btn_width}_${this.start_degree}_${this.end_degree}_${t.color}_${this.line_width}`;if(void 0===this.wm[e]){const i=(this.hole_width+this.btn_width)*this.scale_wm,s=(this.hole_width+this.btn_width)*this.scale_wm,a=.5*i,h=.5*s,r=new OffscreenCanvas(i,s),n=r.getContext("2d");if(n){n.save(),n.beginPath(),n.fillStyle=t.color,n.strokeStyle=t.color,n.lineWidth=this.line_width,n.arc(a,h,this.hole_width,this.angle_degree_for_arc(this.start_degree),this.angle_degree_for_arc(this.end_degree));let i=this.get_angle_position(a,h,this.btn_width,this.end_degree);n.lineTo(i.x,i.y),n.arc(a,h,this.btn_width,this.angle_degree_for_arc(this.end_degree),this.angle_degree_for_arc(this.start_degree),!0);let s=this.get_angle_position(a,h,this.hole_width,this.start_degree);n.lineTo(s.x,s.y),n.fill(),n.stroke(),n.restore(),this.wm[e]=r.transferToImageBitmap()}}void 0!==this.wm[e]&&t.ctx.drawImage(this.wm[e],this.x,this.y)}draw_line(t){const e=`line_${this.hole_width}_${this.btn_width}_${this.start_degree}_${this.end_degree}_${this.color}_${this.line_width}`;if(void 0===this.wm[e]){const t=(this.hole_width+this.btn_width)*this.scale_wm,i=(this.hole_width+this.btn_width)*this.scale_wm,s=.5*t,a=.5*i,h=new OffscreenCanvas(t,i),r=h.getContext("2d");if(r){r.save(),r.beginPath(),r.strokeStyle=this.color,r.lineWidth=this.line_width,r.arc(s,a,this.hole_width,this.angle_degree_for_arc(this.start_degree),this.angle_degree_for_arc(this.end_degree));let t=this.get_angle_position(s,a,this.btn_width,this.end_degree);r.lineTo(t.x,t.y),r.arc(s,a,this.btn_width,this.angle_degree_for_arc(this.end_degree),this.angle_degree_for_arc(this.start_degree),!0);let i=this.get_angle_position(s,a,this.hole_width,this.start_degree);r.lineTo(i.x,i.y),r.stroke(),r.restore(),this.wm[e]=h.transferToImageBitmap()}}void 0!==this.wm[e]&&t.ctx.drawImage(this.wm[e],this.x,this.y)}draw_clear(t){const e=`clear_${this.hole_width}_${this.btn_width}_${this.start_degree}_${this.end_degree}_${this.line_width}`;if(void 0===this.wm[e]){const t=(this.hole_width+this.btn_width+this.line_width)*this.scale_wm,i=(this.hole_width+this.btn_width+this.line_width)*this.scale_wm,s=.5*t,a=.5*i,h=new OffscreenCanvas(t,i),r=h.getContext("2d");if(r){r.save(),r.beginPath(),r.fillStyle="black",r.strokeStyle="black",r.lineWidth=4*this.line_width,r.arc(s,a,this.hole_width,this.angle_degree_for_arc(this.calc_degree(this.start_degree)),this.angle_degree_for_arc(this.calc_degree(this.end_degree)));let t=this.get_angle_position(s,a,this.btn_width,this.calc_degree(this.end_degree));r.lineTo(t.x,t.y),r.arc(s,a,this.btn_width,this.angle_degree_for_arc(this.calc_degree(this.end_degree)),this.angle_degree_for_arc(this.calc_degree(this.start_degree)),!0);let i=this.get_angle_position(s,a,this.hole_width,this.calc_degree(this.start_degree));r.lineTo(i.x,i.y),r.fill(),r.stroke(),r.restore(),this.wm[e]=h.transferToImageBitmap()}}void 0!==this.wm[e]&&(t.ctx.save(),t.ctx.globalCompositeOperation="destination-out",t.ctx.drawImage(this.wm[e],this.x,this.y),t.ctx.restore())}draw_img(t){const e=`img_${this.img_width}_${this.img_height}_${this.hole_width}_${this.btn_width}_${this.start_degree}_${this.end_degree}_${this.padding}_${this.img.src.replace(/[\W_]+/g,"_")}`;if(void 0===this.wm[e]){const t=(this.hole_width+this.btn_width)*this.scale_wm,i=(this.hole_width+this.btn_width)*this.scale_wm,s=.5*t,a=.5*i,h=new OffscreenCanvas(t,i),r=h.getContext("2d");if(r){r.save();const t=this.calc_middle_degree(this.start_degree,this.end_degree),i=this.get_angle_position(s,a,this.btn_width-this.hole_width,t);let n=i.x-.5*this.width,_=i.y-.5*this.height;r.drawImage(this.img,0,0,this.img_width,this.img_height,n+.5*(this.width-(this.width-this.padding)),_+.5*(this.height-(this.height-this.padding)),this.width-this.padding,this.height-this.padding),r.restore(),this.wm[e]=h.transferToImageBitmap()}}void 0!==this.wm[e]&&t.ctx.drawImage(this.wm[e],this.x,this.y)}}e.control=class{debug;game;canvas_width;canvas_height;button_pause;button_fullscreen;button_power;button_action;arrow_right;arrow_down;arrow_left;arrow_up;btn_list=[];btn_gui_list=[];btn_control_list=[];arrow_list=[];canvas_rect;canvas_mark;canvas_control;canvas_pointer;ctx_mark;ctx_control;ctx_pointer;constructor(t){t.debug??=!1,this.debug=t.debug,this.game=t.game,this.canvas_mark=t.canvas_mark,this.canvas_control=t.canvas_control,this.canvas_pointer=t.canvas_pointer,this.ctx_mark=t.ctx_mark,this.ctx_control=t.ctx_control,this.ctx_pointer=t.ctx_pointer,this.canvas_width=t.canvas_width,this.canvas_height=t.canvas_height,this.canvas_rect=this.canvas_mark.getBoundingClientRect();const e=1*a.DPI,i=this.canvas_height-135*a.DPI,n=3*a.DPI;this.arrow_right=new r({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"ArrowRight",img:(0,s.ASSETSVG)("right",s.BTN_COLOR.normal_icon),x:e+n,y:i-n,start_degree:315,end_degree:45}),this.arrow_down=new r({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"ArrowDown",img:(0,s.ASSETSVG)("down",s.BTN_COLOR.normal_icon),x:e,y:i,start_degree:45,end_degree:135}),this.arrow_left=new r({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"ArrowLeft",img:(0,s.ASSETSVG)("left",s.BTN_COLOR.normal_icon),x:e-n,y:i-n,start_degree:135,end_degree:225}),this.arrow_up=new r({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"ArrowUp",img:(0,s.ASSETSVG)("up",s.BTN_COLOR.normal_icon),x:e,y:i-2*n,start_degree:225,end_degree:315}),this.button_fullscreen=new h({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"F11",img:(0,s.ASSETSVG)("full_screen",s.BTN_COLOR.normal_icon),x:this.canvas_width-s.BTN_SIZE-s.BTN_MARGIN,y:110}),this.button_pause=new h({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"Enter",img:(0,s.ASSETSVG)("pause",s.BTN_COLOR.normal_icon),x:this.canvas_width-s.BTN_SIZE-s.BTN_MARGIN,y:this.button_fullscreen.y+s.BTN_SIZE+s.BTN_PADDING}),this.button_power=new h({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:"Control",img:(0,s.ASSETSVG)("lightning",s.BTN_COLOR.normal_icon),x:this.canvas_width-s.BTN_MARGIN-s.BTN_SIZE,y:this.canvas_height-s.BTN_PADDING-s.BTN_MARGIN-2*s.BTN_SIZE}),this.button_action=new h({ctx:this.ctx_control,ctx_mark:this.ctx_mark,debug:this.debug,name:" ",img:(0,s.ASSETSVG)("record",s.BTN_COLOR.normal_icon),x:this.canvas_width-s.BTN_PADDING-s.BTN_MARGIN-2*s.BTN_SIZE,y:this.canvas_height-s.BTN_MARGIN-s.BTN_SIZE}),this.btn_gui_list=[this.button_pause,this.button_fullscreen],this.btn_control_list=[this.button_power,this.button_action],this.btn_list=[...this.btn_gui_list,...this.btn_control_list],this.arrow_list=[this.arrow_right,this.arrow_down,this.arrow_left,this.arrow_up]}resize(){this.canvas_rect=this.canvas_mark.getBoundingClientRect()}draw_gui(){this.btn_gui_list.forEach((t=>{t.draw(),t.draw_mark()}))}draw_fullscreen(){this.redraw_button({btn:this.button_fullscreen,img:(0,s.ASSETSVG)("full_screen",s.BTN_COLOR.normal_icon)}),this.button_fullscreen.draw_mark()}draw_normalscreen(){this.redraw_button({btn:this.button_fullscreen,img:(0,s.ASSETSVG)("normal_screen",s.BTN_COLOR.normal_icon)}),this.button_fullscreen.draw_mark()}draw_pause(){this.redraw_button({btn:this.button_pause,img:(0,s.ASSETSVG)("pause",s.BTN_COLOR.normal_icon)}),this.button_pause.draw_mark()}draw_start(){this.redraw_button({btn:this.button_pause,img:(0,s.ASSETSVG)("start",s.BTN_COLOR.normal_icon)}),this.button_pause.draw_mark()}draw_control(){this.btn_control_list.forEach((t=>{t.draw(),t.draw_mark()}))}draw_arrow(){this.arrow_list.forEach((t=>{t.draw(),t.draw_mark()}))}clear_gui(){this.btn_gui_list.forEach((t=>{t.clear(),t.clear_mark()}))}clear_fullscreen(){this.button_fullscreen.clear(),this.button_fullscreen.clear_mark()}clear_pause(){this.button_pause.clear(),this.button_pause.clear_mark()}clear_control(){this.btn_control_list.forEach((t=>{t.clear(),t.clear_mark()}))}clear_arrow(){this.arrow_list.forEach((t=>{t.clear(),t.clear_mark()}))}redraw_button(t){t.btn&&(t.img||t.color)&&(t.img?(t.color&&(t.btn.color=t.color),t.btn.img=t.img,t.btn.draw()):(t.color&&(t.btn.color=t.color),t.btn.draw()))}redraw_arrow(t){t.arr&&(t.img||t.color)&&(t.img?(t.color&&(t.arr.color=t.color),t.arr.img=t.img,t.arr.draw()):(t.color&&(t.arr.color=t.color),t.arr.draw()))}get_mouse_location(t,e){let i=0,s=0,a=0,h=0,r=t;do{i+=r.offsetLeft-r.scrollLeft,s+=r.offsetTop-r.scrollTop}while(r=r.offsetParent?r.offsetParent:null);a=e.pageX-i,h=e.pageY-s;const n=this.canvas_width/this.canvas_rect.width;return{x:a*n+.5*this.canvas_width,y:h*n+.5*this.canvas_height}}redraw_button_by_event(t,e,i){"keydown"===t?"Control"===e?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("lightning",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):" "===e?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("record",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):"Enter"===e?this.game.game_pause||this.game.game_ready?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("start",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):this.redraw_button({btn:i,img:(0,s.ASSETSVG)("pause",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):"F11"===e&&((0,a.isFullscreen)()?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("normal_screen",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):this.redraw_button({btn:i,img:(0,s.ASSETSVG)("full_screen",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click})):"Control"===e?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("lightning",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):" "===e?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("record",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):"Enter"===e?this.game.game_pause||this.game.game_ready?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("start",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):this.redraw_button({btn:i,img:(0,s.ASSETSVG)("pause",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):"F11"===e&&((0,a.isFullscreen)()?this.redraw_button({btn:i,img:(0,s.ASSETSVG)("normal_screen",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):this.redraw_button({btn:i,img:(0,s.ASSETSVG)("full_screen",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}))}redraw_arrow_by_event(t,e,i){"keydown"===t?"ArrowUp"===e?this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("up",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):"ArrowDown"===e?this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("down",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):"ArrowLeft"===e?this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("left",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):"ArrowRight"===e&&this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("right",s.BTN_COLOR.click_icon),color:s.BTN_COLOR.click}):"keyup"===t&&("ArrowUp"===e?this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("up",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):"ArrowDown"===e?this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("down",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):"ArrowLeft"===e?this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("left",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}):"ArrowRight"===e&&this.redraw_arrow({arr:i,img:(0,s.ASSETSVG)("right",s.BTN_COLOR.normal_icon),color:s.BTN_COLOR.normal}))}mouse_event(t){let{x:e,y:i}=this.get_mouse_location(this.canvas_mark,t.event);if(e>-1&&i>-1){t.debug&&(this.ctx_pointer.clearRect(e-50,i-50,100,100),this.ctx_pointer.fillStyle=`rgba(${s.COLOR.red},0.5)`,this.ctx_pointer.fillRect(e-5,i-5,10,10));const a=this.ctx_mark.getImageData(e,i,1,1).data;if(a&&a.length>3&&a[0]&&a[1]&&a[2]){if(a[0]>0&&a[1]>0&&a[2]>0){const e=this.btn_list.filter((t=>t.uid[0]===a[0]&&t.uid[1]===a[1]&&t.uid[2]===a[2]));if(e&&e.length>0&&e[0]){const i=e[0].name;this.redraw_button_by_event(t.event_name,i,e[0]),window.dispatchEvent(new KeyboardEvent(t.event_name,{key:i}))}else{const e=this.arrow_list.filter((t=>t.uid[0]===a[0]&&t.uid[1]===a[1]&&t.uid[2]===a[2]));if(e&&e.length>0&&e[0]){const i=e[0].name;this.redraw_arrow_by_event(t.event_name,i,e[0]),window.dispatchEvent(new KeyboardEvent(t.event_name,{key:i}))}}}}else 0===a[0]&&0===a[1]&&0===a[2]&&window.dispatchEvent(new KeyboardEvent(t.event_name,{key:" "}))}}attach_mouse(t){t.canvas_mark.addEventListener("mousedown",(e=>{this.mouse_event({event_name:"keydown",event:e,debug:t.debug})})),t.canvas_mark.addEventListener("mouseup",(e=>{this.mouse_event({event_name:"keyup",event:e,debug:t.debug})}))}last_touch_location=[];get_touch_location(t,e){if(e.touches&&e.touches.length>0){const i=this.canvas_width/this.canvas_rect.width;this.last_touch_location=Array.from(e.touches).map((e=>{if(e){let s=0,a=0,h=0,r=0,n=t;do{s+=n.offsetLeft-n.scrollLeft,a+=n.offsetTop-n.scrollTop}while(n=n.offsetParent?n.offsetParent:null);return h=e.pageX-s,r=e.pageY-a,{x:h*i+.5*this.canvas_width,y:r*i+.5*this.canvas_height}}return{x:-1,y:-1}}))}return this.last_touch_location}touch_event(t){let e=this.get_touch_location(this.canvas_mark,t.event);e&&e.length>0&&e.forEach((({x:e,y:i})=>{if(e>-1&&i>-1){t.debug&&(this.ctx_pointer.clearRect(e-50,i-50,100,100),this.ctx_pointer.fillStyle=`rgba(${s.COLOR.red},0.5)`,this.ctx_pointer.fillRect(e-5,i-5,10,10));const a=this.ctx_mark.getImageData(e,i,1,1).data;if(a&&a.length>3&&a[0]&&a[1]&&a[2]){if(a[0]>0&&a[1]>0&&a[2]>0){const e=this.btn_list.filter((t=>t.uid[0]===a[0]&&t.uid[1]===a[1]&&t.uid[2]===a[2]));if(e&&e.length>0&&e[0]){const i=e[0].name;this.redraw_button_by_event(t.event_name,i,e[0]),window.dispatchEvent(new KeyboardEvent(t.event_name,{key:i}))}else{const e=this.arrow_list.filter((t=>t.uid[0]===a[0]&&t.uid[1]===a[1]&&t.uid[2]===a[2]));if(e&&e.length>0&&e[0]){const i=e[0].name;this.redraw_arrow_by_event(t.event_name,i,e[0]),window.dispatchEvent(new KeyboardEvent(t.event_name,{key:i}))}}}}else 0===a[0]&&0===a[1]&&0===a[2]&&window.dispatchEvent(new KeyboardEvent(t.event_name,{key:" "}))}}))}attach_touch(t){t.canvas_mark.addEventListener("touchstart",(e=>{this.touch_event({event_name:"keydown",event:e,debug:t.debug})})),t.canvas_mark.addEventListener("touchend",(e=>{this.touch_event({event_name:"keyup",event:e,debug:t.debug})}))}}},502:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.cookie=void 0,e.cookie={set:(t,e,i,s)=>{i??=7;let a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3);const h=`expires=${a.toUTCString()};`,r=`path=${s||window.location.hostname};`,n=`${t}=${e};`;document.cookie=`${n}${h}samesite=strict;${r}`},delete:t=>{e.cookie.set(t,"",-1)},get:t=>{t=`${t}=`;const e=decodeURIComponent(document.cookie).split("; ");let i=null;return e.forEach((e=>{0===e.indexOf(t)&&(i=e.substring(t.length))})),i}}},133:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.dust=void 0;const s=i(217),a=i(882);class h extends s.particle{color;constructor(t){super({ctx:t.ctx,x:t.x,y:t.y}),this.color=t.color}draw(){this.ctx.beginPath(),this.ctx.arc((0,a.MathFloor)(this.x),(0,a.MathFloor)(this.y),this.size,0,a.MathPI2),this.ctx.fillStyle=this.color,this.ctx.fill()}}e.dust=h},876:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.baseEnemy=void 0;const s=i(882),a=i(877),h=i(556);class r extends a.baseAnimation{debug=!1;uid;uid_text;uid_number;ctx_collision;canvas_width;canvas_height;point;explode_in;explode_out;have_particle;have_shadow;can_move;collision_x;collision_y;collision_adjust_x;collision_adjust_y;collision_scale;constructor(t){super(t),t.debug??=!1,t.explode_in??=!1,t.explode_out??=!1,t.have_particle??=!1,t.have_shadow??=!0,t.can_move??=!0,t.point??=1,t.collision_scale??=.5,t.collision_x??=0,t.collision_y??=0,this.debug=t.debug,this.uid=(0,s.genUID)(),this.uid_number=`${this.uid[0]},${this.uid[1]},${this.uid[2]}`,this.uid_text=`rgb(${this.uid[0]},${this.uid[1]},${this.uid[2]})`,this.canvas_width=t.canvas_width,this.canvas_height=t.canvas_height,this.explode_in=t.explode_in,this.explode_out=t.explode_out,this.have_particle=t.have_particle,this.have_shadow=t.have_shadow,this.can_move=t.can_move,this.point=t.point,this.collision_scale=t.collision_scale,this.collision_adjust_x=t.collision_x,this.collision_adjust_y=t.collision_y,this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale,this.collision_y=this.y+this.collision_adjust_y+this.height*this.collision_scale}update(t){super.update(t),this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale,this.collision_y=this.y+this.collision_adjust_y+this.height*this.collision_scale}draw(){this.ctx_collision&&(this.ctx_collision.fillStyle=this.uid_text,this.ctx_collision.fillRect((0,s.MathFloor)(this.x),(0,s.MathFloor)(this.y),this.width,this.height)),super.draw(),this.debug&&(this.ctx.save(),this.ctx.strokeStyle=`rgb(${h.COLOR.light})`,this.ctx.beginPath(),this.ctx.arc((0,s.MathFloor)(this.collision_x),(0,s.MathFloor)(this.collision_y),100*this.collision_scale,0,s.MathPI2),this.ctx.stroke(),this.ctx.restore())}set_position(t){super.set_position(t),this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale}is_collide(t){const e=this.collision_x-t.player.collision_x,i=this.collision_y-t.player.collision_y;return Math.sqrt(e*e+i*i)<this.width*this.collision_scale+t.player.width*t.player.collision_scale}}e.baseEnemy=r},567:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy1=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{life_index;life_length;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=293*e,h=155*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy1),x:(0,a.MathRandom)()*(t.canvas_width-i)+.5*t.canvas_width,y:(0,a.MathRandom)()*(t.canvas_height-h),width:i,height:h,sprite_width:293,sprite_height:155,sprite_length:5,explode_in:!0,explode_out:!0,point:4}),this.life_index=0,this.life_length=5e3*(0,a.MathRandom)()+5e3}update(t){this.x+=7*(0,a.MathRandom)()-3.5,this.y+=7*(0,a.MathRandom)()-3.5,this.life_index+=t.delta_time,this.life_index>this.life_length&&(this.mark_delete=!0),super.update(t)}}e.enemy1=r},615:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy10=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{constructor(t){const e=.75*(0,a.MathRandom)()+.95,i=60*e,h=87*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy10),x:t.canvas_width+i,y:t.canvas_height-h,width:i,height:h,sprite_width:60,sprite_height:87,sprite_length:5,have_shadow:!1,can_move:!1,point:1})}}e.enemy10=r},59:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy11=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{destination_y;speed;string_x;string_y;constructor(t){const e=.5*(0,a.MathRandom)()+.7,i=120*e,h=144*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy11),x:t.canvas_width+i,y:(0,a.MathRandom)()>.5?(0,a.MathRandom)()*(t.canvas_height-h):0-h,width:i,height:h,sprite_width:120,sprite_height:144,sprite_length:5,point:3}),this.destination_y=(0,a.MathRandom)()*(.8*(t.canvas_height-this.height)),this.speed=2*(0,a.MathRandom)()-4,this.y<this.destination_y&&(this.speed*=-1),this.string_x=this.x+.5*this.width,this.string_y=this.y+50}update(t){this.y+=this.speed,this.string_y=this.y+50,this.string_x=this.x+.5*this.width,this.y>this.destination_y&&this.speed>0&&(this.speed*=-1),this.y<0-this.height-5&&(this.mark_delete=!0),super.update(t)}draw(){this.ctx.beginPath(),this.ctx.moveTo((0,a.MathFloor)(this.string_x),0),this.ctx.lineTo((0,a.MathFloor)(this.string_x),(0,a.MathFloor)(this.string_y)),this.ctx.stroke(),super.draw()}set_position(t){super.set_position(t),this.string_x=this.x+.5*this.width,this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale}}e.enemy11=r},787:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy2=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{move_speed;angle;angle_speed;curve;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=266*e,h=188*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy2),x:t.canvas_width,y:(0,a.MathRandom)()*(t.canvas_height-h),width:i,height:h,sprite_width:266,sprite_height:188,sprite_length:5,have_particle:!0,point:3}),this.move_speed=4*(0,a.MathRandom)()+1,this.angle=2*(0,a.MathRandom)(),this.angle_speed=.2*(0,a.MathRandom)(),this.curve=5*(0,a.MathRandom)()}update(t){this.x-=this.move_speed,this.x<0-this.width&&(this.mark_delete=!0),this.y+=this.curve*Math.sin(this.angle),this.angle+=this.angle_speed,super.update(t)}}e.enemy2=r},18:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy3=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{angle;angle_speed;life_index;life_length;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=218*e,h=177*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy3),x:t.canvas_width,y:(0,a.MathRandom)()*(t.canvas_height-h),width:i,height:h,sprite_width:218,sprite_height:177,sprite_length:5,explode_out:!0,have_particle:!0,point:3}),this.angle=2*(0,a.MathRandom)(),this.angle_speed=.5*(0,a.MathRandom)()+.5,this.life_index=0,this.life_length=5e3*(0,a.MathRandom)()+5e3}update(t){this.x=this.canvas_width/2*Math.cos(this.angle*Math.PI/90)+(this.canvas_width/2-this.width/2),this.x+this.width<0&&(this.x=this.canvas_width),this.y=this.canvas_height/2*Math.sin(this.angle*Math.PI/270)+(this.canvas_height/2-this.height/2),this.y+this.height<0&&(this.y=this.canvas_height),this.angle+=this.angle_speed,this.life_index+=t.delta_time,this.life_index>this.life_length&&(this.mark_delete=!0),super.update(t)}}e.enemy3=r},978:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy4=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{new_x;new_y;last_move;interval;life_index;life_length;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=213*e,h=213*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy4),x:(0,a.MathRandom)()*(t.canvas_width-i)+.5*t.canvas_width,y:(0,a.MathRandom)()*(t.canvas_height-h),width:i,height:h,sprite_width:213,sprite_height:213,sprite_length:8,explode_in:!0,explode_out:!0,have_particle:!0,point:5}),this.new_x=(0,a.MathRandom)()*(t.canvas_width-i),this.new_y=(0,a.MathRandom)()*(t.canvas_height-h),this.last_move=0,this.interval=(0,a.MathFloor)(200*(0,a.MathRandom)()+50),this.life_index=0,this.life_length=5e3*(0,a.MathRandom)()+5e3}update(t){this.last_move%this.interval==0&&(this.last_move=0,this.new_x=(0,a.MathRandom)()*(this.canvas_width-this.width),this.new_y=(0,a.MathRandom)()*(this.canvas_height-this.height)),this.last_move++;let e=this.x-this.new_x,i=this.y-this.new_y;this.x-=e/20,this.y-=i/20,this.life_index+=t.delta_time,this.life_index>this.life_length&&(this.mark_delete=!0),super.update(t)}set_position(t){super.set_position(t),this.new_x-=t.game_speed,this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale}}e.enemy4=r},512:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy5=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{direction_x;direction_y;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=271*e,h=194*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy5),x:t.canvas_width,y:(0,a.MathRandom)()*(t.canvas_height-h),width:i,height:h,sprite_width:271,sprite_height:194,sprite_length:5,have_particle:!0,point:3}),this.direction_x=3*(0,a.MathRandom)()+1.5,this.direction_y=5*(0,a.MathRandom)()-2.5}update(t){this.x-=this.direction_x,this.y-=this.direction_y,this.x<0-this.width&&(this.mark_delete=!0),(this.y<0||this.y>this.canvas_height-this.height)&&(this.direction_y=-1*this.direction_y),super.update(t)}}e.enemy5=r},527:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy6=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{speed;angle;curve;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=261*e,h=209*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy6),x:t.canvas_width,y:(0,a.MathRandom)()*t.canvas_height*.5,width:i,height:h,sprite_width:261,sprite_height:209,sprite_length:5,have_shadow:!1,point:4}),this.speed=2*(0,a.MathRandom)()+2,this.angle=0,this.curve=3*(0,a.MathRandom)()}update(t){this.x-=this.speed,this.y+=Math.sin(this.angle)*this.curve,this.angle+=.04,this.x<0-this.width&&(this.mark_delete=!0),super.update(t)}draw(){this.ctx.save(),this.ctx.globalAlpha=.5,super.draw(),this.ctx.restore()}}e.enemy6=r},975:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy7=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{move_speed;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=229*e,h=171*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy7),x:t.canvas_width+i,y:t.canvas_height-h,width:i,height:h,sprite_width:229,sprite_height:171,sprite_length:5,have_shadow:!1,point:2}),this.move_speed=10*(0,a.MathRandom)()+5}update(t){this.x-=(0,a.MathRandom)()*this.move_speed,this.x<0-this.width&&(this.mark_delete=!0),super.update(t)}}e.enemy7=r},476:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy8=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{destination_y;speed;string_x;string_y;constructor(t){const e=.1*(0,a.MathRandom)()+.3,i=310*e,h=175*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy8),x:t.canvas_width+i,y:(0,a.MathRandom)()>.5?(0,a.MathRandom)()*(t.canvas_height-h):0-h,width:i,height:h,sprite_width:310,sprite_height:175,sprite_length:5,point:3}),this.destination_y=(0,a.MathRandom)()*(.8*(t.canvas_height-this.height)),this.speed=2*(0,a.MathRandom)()-4,this.y<this.destination_y&&(this.speed*=-1),this.string_x=this.x+.5*this.width,this.string_y=this.y+10}update(t){this.y+=this.speed,this.string_y=this.y+10,this.string_x=this.x+.5*this.width,this.y>this.destination_y&&this.speed>0&&(this.speed*=-1),this.y<0-this.height-5&&(this.mark_delete=!0),super.update(t)}draw(){this.ctx.beginPath(),this.ctx.moveTo((0,a.MathFloor)(this.string_x),0),this.ctx.lineTo((0,a.MathFloor)(this.string_x),(0,a.MathFloor)(this.string_y)),this.ctx.stroke(),super.draw()}set_position(t){super.set_position(t),this.string_x=this.x+.5*this.width,this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale}}e.enemy8=r},144:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enemy9=void 0;const s=i(556),a=i(882),h=i(876);class r extends h.baseEnemy{move_speed;angle;angle_speed;curve;constructor(t){const e=.8*(0,a.MathRandom)()+1.1,i=60*e,h=44*e;super({...t,img:(0,s.ASSETIMG)(s.ASSET.enemy.enemy9),x:t.canvas_width,y:(0,a.MathRandom)()*(t.canvas_height-h),width:i,height:h,sprite_width:60,sprite_height:44,sprite_length:5,have_particle:!0,point:3}),this.move_speed=4*(0,a.MathRandom)()+1,this.angle=2*(0,a.MathRandom)(),this.angle_speed=.2*(0,a.MathRandom)(),this.curve=5*(0,a.MathRandom)()}update(t){this.x-=this.move_speed,this.x<0-this.width&&(this.mark_delete=!0),this.y+=this.curve*Math.sin(this.angle),this.angle+=this.angle_speed,super.update(t)}}e.enemy9=r},972:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.explosion=void 0;const s=i(556),a=i(877),h=i(882);class r extends a.baseAnimation{sound_played;angle;dx;dy;sx;constructor(t){const e=200*t.scale,i=179*t.scale;super({img:(0,s.ASSETIMG)(s.ASSET.boom),ctx:t.ctx,x:t.x,y:t.y,width:e,height:i,sprite_width:200,sprite_height:179,sprite_length:6,fps:24,animation_repeat:1}),t.play_sound??=!0,t.play_sound&&(this.sound_played=!1),this.angle=180*(0,h.MathRandom)(),this.dx=0-.5*this.width,this.dy=0-.5*this.height,this.sx=0}update(t){if(!1===this.sound_played){this.sound_played=!0;new Audio(s.ASSET.boom_wav).play()}super.update({delta_time:t.delta_time})}draw(){this.ctx.save(),this.ctx.translate((0,h.MathFloor)(this.x),(0,h.MathFloor)(this.y)),this.ctx.rotate(this.angle),this.ctx.drawImage(this.img_sprite[this.frame_x],(0,h.MathFloor)(this.dx),(0,h.MathFloor)(this.dy)),this.ctx.restore()}}e.explosion=r},991:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fire=void 0;const s=i(556),a=i(877),h=i(882);class r extends a.baseAnimation{angle;dx;dy;sx;constructor(t){const e=.5*(0,h.MathRandom)()+.5,i=100*e,a=90*e;super({img:(0,s.ASSETIMG)(s.ASSET.fire),ctx:t.ctx,x:t.x,y:t.y,width:i,height:a,sprite_width:100,sprite_height:90,sprite_length:6,fps:24,animation_repeat:1}),this.angle=180*(0,h.MathRandom)(),this.dx=0-.5*this.width,this.dy=0-.5*this.height,this.sx=0}draw(){this.ctx.save(),this.ctx.translate((0,h.MathFloor)(this.x),(0,h.MathFloor)(this.y)),this.ctx.rotate(this.angle),this.ctx.drawImage(this.img_sprite[this.frame_x],(0,h.MathFloor)(this.dx),(0,h.MathFloor)(this.dy)),this.ctx.restore()}}e.fire=r},769:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.game=void 0;const s=i(971),a=i(205),h=i(567),r=i(787),n=i(18),_=i(978),o=i(512),l=i(527),c=i(975),d=i(476),g=i(144),m=i(615),p=i(59),w=i(972),u=i(991),y=i(251),x=i(374),v=i(882),S=i(489),f=i(461),b=i(133),E=i(324),T=i(906),A=i(556),O=i(295),R={enemy1:h.enemy1,enemy2:r.enemy2,enemy3:n.enemy3,enemy4:_.enemy4,enemy5:o.enemy5,enemy6:l.enemy6,enemy7:c.enemy7,enemy8:d.enemy8,enemy9:g.enemy9,enemy10:m.enemy10,enemy11:p.enemy11},k=["enemy1","enemy2","enemy3","enemy4","enemy5","enemy6","enemy7","enemy8","enemy9","enemy10","enemy11"];e.game=class{CURRENT_ANIMATION_ID=(0,v.MathRandom)();canvas_game;canvas_static;canvas_value;canvas_control;canvas_pointer;canvas_mark;ctx_game;ctx_static;ctx_value;ctx_control;ctx_pointer;ctx_mark;canvas_width;canvas_height;base_height;ctl;gui;bg;player;input;prg_game;prg_life;prg_power;enemy_list=[];explosion_list=[];dust_list=[];fire_list=[];shadow_list=[];score_list=[];progress_list=[];dust_max=50;fire_max=50;debug=!1;game_up=!1;game_over=!1;game_timeout=!1;game_pause=!1;game_ready=!1;game_fps=0;game_fps_list=[];score_value=0;score_text="0";progress_index=0;progress_max=1e3;progress_timer=0;progress_timer_index=0;game_level=1;enemy_max=5;enemy_index=0;enemy_interval=0;enemy_interval_max=2e3;constructor(t){this.canvas_game=t.canvas_game,this.canvas_static=t.canvas_static,this.canvas_value=t.canvas_value,this.canvas_control=t.canvas_control,this.canvas_pointer=t.canvas_pointer,this.canvas_mark=t.canvas_mark,this.ctx_game=t.canvas_game.getContext("2d",{alpha:!1}),this.ctx_static=t.canvas_static.getContext("2d"),this.ctx_value=t.canvas_value.getContext("2d"),this.ctx_control=t.canvas_control.getContext("2d"),this.ctx_pointer=t.canvas_pointer.getContext("2d"),this.ctx_mark=t.canvas_mark.getContext("2d"),this.canvas_width=t.canvas_game.width,this.canvas_height=t.canvas_game.height,t.debug??=!1,this.debug=t.debug,this.input=new S.input({debug:this.debug}),this.ctl=new E.control({game:this,canvas_control:this.canvas_control,canvas_mark:this.canvas_mark,canvas_pointer:this.canvas_pointer,ctx_control:this.ctx_control,ctx_mark:this.ctx_mark,ctx_pointer:this.ctx_pointer,canvas_width:this.canvas_width,canvas_height:this.canvas_height,debug:this.debug}),this.gui=new T.gui({ctx:this.ctx_static,canvas_width:this.canvas_width,canvas_height:this.canvas_height,debug:this.debug}),this.bg=new s.bg1({ctx:this.ctx_game,canvas_width:this.canvas_width,canvas_height:this.canvas_height}),this.base_height=this.canvas_height-this.bg.ground,this.player=new y.player({game:this,ctx:this.ctx_game,canvas_width:this.canvas_width,canvas_height:this.base_height,x:(0,v.isTouchDevice)()?.25*this.canvas_width:.1*this.canvas_width,debug:this.debug}),this.prg_game=new x.progress({ctx:this.ctx_value,x:.5*this.canvas_width-.4*this.canvas_width*.5,y:60,min:0,max:this.progress_max,width:.4*this.canvas_width,value:this.progress_index,bar_color:[`rgb(${A.COLOR.red})`,`rgb(${A.COLOR.yellow})`,`rgb(${A.COLOR.green})`]}),this.prg_life=new x.progress({ctx:this.ctx_value,x:this.canvas_width-130,y:30,width:100,value:this.player.life,max:100,bar_color:[`rgb(${A.COLOR.red})`,`rgb(${A.COLOR.yellow})`,`rgb(${A.COLOR.green})`]}),this.prg_power=new x.progress({ctx:this.ctx_value,x:this.canvas_width-130,y:60,width:100,value:this.player.power,max:100,bar_color:[`rgb(${A.COLOR.red})`,`rgb(${A.COLOR.yellow})`,`rgb(${A.COLOR.green})`]}),window.addEventListener("keyup",this.game_halt_listener),this.draw_gui()}draw_gui(){requestIdleCallback((()=>{this.gui.draw(),this.ctl.draw_gui(),(0,v.isTouchDevice)()?(this.ctl.draw_control(),this.ctl.draw_arrow(),this.ctl.attach_touch({canvas_mark:this.canvas_mark,marker_ctx:this.ctx_mark,pointer_ctx:this.ctx_pointer,control_ctx:this.ctx_control,debug:this.debug})):(this.debug&&(this.ctl.draw_control(),this.ctl.draw_arrow()),this.ctl.attach_mouse({canvas_mark:this.canvas_mark,marker_ctx:this.ctx_mark,pointer_ctx:this.ctx_pointer,control_ctx:this.ctx_control,debug:this.debug}))}))}resize(){this.ctl.resize()}gen_enemy_interval(){return this.enemy_interval_max-100*this.game_level}game_bg(){this.clean_ctx_value_message(),this.game_level%2==0?this.bg=new s.bg1({ctx:this.ctx_game,canvas_width:this.canvas_width,canvas_height:this.canvas_height}):this.bg=new a.bg2({ctx:this.ctx_game,canvas_width:this.canvas_width,canvas_height:this.canvas_height}),this.base_height=this.canvas_height-this.bg.ground,this.player.canvas_height=this.base_height}add_player_shadow(){this.bg.support_shadow&&this.shadow_list.push(new O.shadow({ctx:this.ctx_game,ground:this.base_height,element:this.player}))}game_start(t){t??={game_score:0,game_level:1,player_life:100,player_power:0},this.game_level=t.game_level,this.game_bg(),this.progress_index=0,this.progress_max=1e3,this.progress_timer=performance.now()+12e4,this.progress_timer_index=120,this.enemy_index=0;let e=this.gen_enemy_interval();this.enemy_interval=(0,v.MathRandom)()*e+e,(0,v.clearArray)(this.enemy_list),(0,v.clearArray)(this.explosion_list),(0,v.clearArray)(this.dust_list),(0,v.clearArray)(this.fire_list),(0,v.clearArray)(this.shadow_list),(0,v.clearArray)(this.score_list),this.player.set_state("idle"),this.player.life=t.player_life,this.player.life>100&&(this.player.life=100),this.player.power=t.player_power,this.player.speed=0,this.player.max_speed=20,this.player.weight=1,this.player.velocity_y=0,this.player.y=this.base_height-this.player.height,this.player.powered=!1,this.player.invulnerable=!1,this.score_value=t.game_score,this.score_text=t.game_score.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),this.draw_life(),this.draw_timer(),this.draw_score(),this.draw_level(),this.add_player_shadow(),this.check_fps(24,0,this.CURRENT_ANIMATION_ID,((t,e)=>{this.game_over=!1,this.game_timeout=!1,this.game_pause=!1,this.ctl.clear_control(),this.ctl.clear_arrow(),this.ctl.draw_start(),this.clean_ctx_value_message(),this.animate(t,e),this.game_ready=!0}))}game_level_up(){this.game_level++,this.game_bg(),this.progress_index=0,this.progress_max=1e3,this.progress_timer=performance.now()+12e4,this.progress_timer_index=120,this.enemy_index=0;let t=this.gen_enemy_interval();this.enemy_interval=(0,v.MathRandom)()*t+t,(0,v.clearArray)(this.enemy_list),(0,v.clearArray)(this.explosion_list),(0,v.clearArray)(this.dust_list),(0,v.clearArray)(this.shadow_list),(0,v.clearArray)(this.fire_list),this.player.set_state("idle"),this.player.life+=10,this.player.life>100&&(this.player.life=100),this.player.speed=0,this.player.max_speed=20,this.player.weight=1,this.player.velocity_y=0,this.player.y=this.base_height-this.player.height,this.player.powered=!1,this.player.invulnerable=!1,this.draw_life(),this.draw_timer(),this.draw_level(),this.ctl.draw_pause(),this.add_player_shadow(),((0,v.isTouchDevice)()||this.debug)&&(this.ctl.draw_control(),this.ctl.draw_arrow()),this.check_fps(24,0,this.CURRENT_ANIMATION_ID,((t,e)=>{this.game_up=!1,this.player.set_state("run"),this.animate(t,e)}))}game_continue(){this.progress_timer=performance.now()+1e3*this.progress_timer_index,this.ctl.draw_pause(),((0,v.isTouchDevice)()||this.debug)&&(this.ctl.draw_control(),this.ctl.draw_arrow()),this.check_fps(24,0,this.CURRENT_ANIMATION_ID,((t,e)=>{this.game_pause=!1,this.game_ready=!1,this.clean_ctx_value_message(),this.animate(t,e)}))}add_explosion(t,e){this.explosion_list.push(new w.explosion({ctx:this.ctx_game,x:t.x+.5*t.width,y:t.y+.5*t.height,scale:.008*t.width,play_sound:e}))}add_floating_score(t,e){let i=(0,v.MathFloor)(.1*(100-t.y/(t.canvas_height-t.height+this.base_height)*100)*t.point);e&&i>0&&(i*=-1),!e&&i<0&&(i*=-1),this.score_list.push(new f.score({ctx:this.ctx_game,text:`${i>0?"+":""}${i}`,value:i,x:t.x+.5*t.width,y:t.y+.5*t.height,destination_x:90,destination_y:60}))}collision_detection(){this.enemy_list.forEach((t=>{t.mark_delete||t.is_collide({player:this.player})&&(this.player.is_powered()?(t.explode_out=!1,this.add_explosion(t,!0),this.add_floating_score(t,!1),t.mark_delete=!0):(this.player.invulnerable||(this.player.life>30?(this.player.life-=10,this.player.set_state("gethit"),this.draw_life()):this.player.life>0?(this.player.life-=10,this.player.set_state("dizzy"),this.draw_life()):(this.player.set_state("ko"),setTimeout((()=>{this.set_game_over()}),500))),this.game_over||this.game_timeout||(t.explode_out=!1,this.add_explosion(t,!1),this.add_floating_score(t,!0),t.mark_delete=!0)))}))}last_draw_message_title="";last_draw_message_message="";draw_message(t,e,i){this.last_draw_message_title=t,this.last_draw_message_message=e,this.debug&&this.clear_message(t,e),(0,v.draw_text)({ctx:this.ctx_value,x:.5*this.canvas_width,y:.5*this.base_height-20,text:t,font_weight:60,text_align:"center",text_color:i,debug:this.debug}),(0,v.draw_text)({ctx:this.ctx_value,x:.5*this.canvas_width,y:.5*this.base_height+20,text:e,font_weight:30,text_align:"center",text_color:i,debug:this.debug})}clear_message(t,e){(0,v.clear_text)({ctx:this.ctx_value,x:.5*this.canvas_width,y:.5*this.base_height-20,text:t,font_weight:60,text_align:"center",debug:this.debug}),(0,v.clear_text)({ctx:this.ctx_value,x:.5*this.canvas_width,y:.5*this.base_height+20,text:e,font_weight:30,text_align:"center",debug:this.debug})}clean_ctx_value_message(){this.clear_message(this.last_draw_message_title,this.last_draw_message_message)}draw_level(){(0,v.draw_clear_text)({ctx:this.ctx_value,x:.5*(this.canvas_width-this.prg_game.width),y:50,text:`Level ${this.game_level}`,text_align:"start",font_weight:25,debug:this.debug})}draw_timer(){(0,v.draw_clear_text)({ctx:this.ctx_value,x:.5*(this.canvas_width+this.prg_game.width),y:50,text:`${new Date(1e3*this.progress_timer_index).toISOString().substring(15,19)}`,text_align:"end",text_color:this.progress_timer_index<20?`rgb(${A.COLOR.red})`:`rgb(${A.COLOR.light})`,font_weight:25,debug:this.debug})}draw_score(){(0,v.draw_clear_text)({ctx:this.ctx_value,x:90,y:80,text:`${this.score_text}`,text_color:this.score_value<0?`rgb(${A.COLOR.red})`:`rgb(${A.COLOR.light})`,font_weight:60,debug:this.debug})}draw_life(){this.prg_life.update(this.player.life),this.prg_life.draw()}draw_power(){this.prg_power.update(this.player.power),this.prg_power.draw()}draw_progress(){this.prg_game.update(this.progress_index,0,this.progress_max),this.prg_game.draw()}draw_status(){this.draw_progress(),this.draw_power(),this.game_over&&this.draw_message("Game over!",(0,v.isTouchDevice)()?"Press START to try again.":"Press START/ENTER to try again.",`rgb(${A.COLOR.red})`),this.game_timeout&&this.draw_message("Times up!",(0,v.isTouchDevice)()?"Press START to try again.":"Press START/ENTER to try again.",`rgb(${A.COLOR.red})`),this.game_up&&this.draw_message(`Level ${this.game_level} complete!`,(0,v.isTouchDevice)()?"Press START to continue.":"Press START/ENTER to continue.",`rgb(${A.COLOR.green})`),this.game_pause&&this.draw_message("Pause!",(0,v.isTouchDevice)()?"Press START to continue.":"Press START/ENTER to continue.",`rgb(${A.COLOR.light})`),this.game_ready&&this.draw_message("Are you ready?",(0,v.isTouchDevice)()?"Press START to continue.":"Press START/ENTER to continue.",`rgb(${A.COLOR.green})`)}set_game_over(){this.ctl.clear_control(),this.ctl.clear_arrow(),this.ctl.draw_start(),this.game_over=!0,this.canvas_game.dispatchEvent(new CustomEvent("game_over"))}set_game_up(){this.ctl.clear_control(),this.ctl.clear_arrow(),this.ctl.draw_start(),this.game_up=!0;let t=0;this.score_list.forEach((e=>{t+=e.value})),this.canvas_game.dispatchEvent(new CustomEvent("game_up",{detail:{game_score:this.score_value+t,game_level:this.game_level+1,player_life:this.player.life+10,player_power:this.player.power}}))}last_timestamp=0;update(t){const e=t-this.last_timestamp;if(this.last_timestamp=t,this.progress_index+=.1*this.player.speed,this.progress_index>=this.progress_max&&(this.score_list.push(new f.score({ctx:this.ctx_game,text:`+${this.progress_timer_index.toString().padStart(2,"0")}`,value:this.progress_timer_index,x:.5*(this.canvas_width+this.prg_game.width)-120,y:25,destination_x:90,destination_y:60})),this.set_game_up()),this.progress_timer_index=(0,v.MathFloor)(.001*(this.progress_timer-t)),this.progress_timer_index>120&&(this.progress_timer_index=120),this.progress_timer_index<=0?(this.ctl.clear_control(),this.ctl.clear_arrow(),this.ctl.draw_start(),this.game_timeout=!0):this.draw_timer(),this.player.power+=.1,this.player.power>100&&(this.player.power=100),this.bg.update({game_speed:this.player.speed}),this.player.update_input(this.input),this.player.update({delta_time:e}),this.player.speed===this.player.max_speed&&Array(3).fill(0).forEach((t=>{this.fire_list.unshift(new u.fire({ctx:this.ctx_game,x:this.player.x+50+10*(0,v.MathRandom)()-10,y:this.player.y+100+10*(0,v.MathRandom)()-10}))})),this.enemy_index>=this.enemy_interval){if(this.enemy_list.length<=this.enemy_max){const t=k[(0,v.MathFloor)((0,v.MathRandom)()*k.length)],e=new(0,R[t])({ctx:this.ctx_game,canvas_width:this.canvas_width,canvas_height:this.base_height,debug:this.debug});(this.player.speed>0||0===this.player.speed&&e.can_move)&&(e.explode_in&&this.explosion_list.push(new w.explosion({ctx:this.ctx_game,x:e.x+.5*e.width,y:e.y+.5*e.height,scale:e.width/e.sprite_width*1.5,play_sound:!1})),e.have_shadow&&this.bg.support_shadow&&this.shadow_list.push(new O.shadow({ctx:this.ctx_game,ground:this.base_height,element:e})),this.enemy_list.push(e),this.enemy_list.sort(((t,e)=>t.width-e.width)))}let t=this.gen_enemy_interval();this.enemy_interval=(0,v.MathRandom)()*t+t,this.enemy_index=0}else this.enemy_index+=e;[...this.fire_list,...this.dust_list,...this.shadow_list,...this.explosion_list].forEach((t=>{t.update({delta_time:e}),t.set_position({game_speed:this.player.speed})})),this.score_list.forEach((t=>{t.update(),t.mark_delete&&(this.score_value+=t.value,this.score_text=this.score_value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),this.draw_score())})),this.enemy_list.forEach((t=>{t.update({delta_time:e}),t.set_position({game_speed:this.player.speed}),t.x<0-t.width?t.mark_delete=!0:t.mark_delete&&t.explode_out&&this.add_explosion(t,!1),t.have_particle&&this.dust_list.unshift(new b.dust({ctx:this.ctx_game,x:t.x+.5*t.width+50*(0,v.MathRandom)()-25,y:t.y+.5*t.height+30*(0,v.MathRandom)()-15,color:`rgba(${t.uid_number},0.2)`}))})),this.collision_detection(),this.score_list=this.score_list.filter((t=>!t.mark_delete)),this.dust_list=this.dust_list.filter((t=>!t.mark_delete)),this.shadow_list=this.shadow_list.filter((t=>!t.mark_delete)),this.fire_list=this.fire_list.filter((t=>!t.mark_delete)),this.explosion_list=this.explosion_list.filter((t=>!t.mark_delete)),this.enemy_list=this.enemy_list.filter((t=>!t.mark_delete)),this.dust_list.length>this.dust_max&&(this.dust_list=this.dust_list.slice(0,this.dust_max)),this.fire_list.length>this.fire_max&&(this.fire_list=this.fire_list.slice(0,this.fire_max))}draw(){[this.bg,...this.fire_list,...this.dust_list,...this.shadow_list,...this.score_list,...this.enemy_list,this.player,...this.explosion_list].forEach((t=>{t.draw()}))}game_halt_listener=t=>{if("Enter"===t.key)t.preventDefault(),t.stopPropagation(),this.game_up||this.game_over||this.game_timeout||this.game_pause||this.game_ready?((this.game_over||this.game_timeout)&&this.game_start(),this.game_up&&this.game_level_up(),this.game_pause&&this.game_continue(),this.game_ready&&this.game_continue()):(this.ctl.clear_control(),this.ctl.clear_arrow(),this.ctl.draw_start(),this.game_pause=!0);else if("F11"===t.key)if(t.preventDefault(),t.stopPropagation(),(0,v.isFullscreen)())document.exitFullscreen().then((()=>{(0,v.isFullscreen)()||this.ctl.draw_fullscreen()})).catch((t=>{console.log(t)}));else{this.canvas_game.parentElement.requestFullscreen({navigationUI:"hide"}).then((()=>{(0,v.isFullscreen)()&&this.ctl.draw_normalscreen()})).catch((t=>{console.log(t)}))}};last_fps_timestamp=0;check_fps(t,e,i,s){const a=e-1e3;this.game_fps_list.length>0&&(this.game_fps_list=this.game_fps_list.filter((t=>t>a))),this.game_fps_list.push(e),this.game_fps=this.game_fps_list.length,this.game_fps>=t?s(e,i):requestAnimationFrame((e=>{this.CURRENT_ANIMATION_ID===i&&this.check_fps(t,e,i,s)}))}debug_info(){let t=0;const e=(e,i,s)=>{(0,v.draw_clear_text)({ctx:this.ctx_value,x:e,y:120+25*t++,shadow_blur:0,text:i,text_color:s||`rgb(${A.COLOR.yellow})`,font_family:"Arial",font_weight:20,debug:this.debug})};e(78,`${this.game_fps}`,this.game_fps<30?`rgb(${A.COLOR.red})`:`rgb(${A.COLOR.yellow})`),e(80,`${this.dust_list.length}`),e(73,`${this.fire_list.length}`),e(125,`${this.explosion_list.length}`),e(100,`${this.enemy_list.length}`),e(90,`${this.score_list.length}`),e(115,`${(0,v.read_random_index)()}`)}do_animate=(t,e)=>{this.update(t),this.draw(),this.draw_status(),this.debug&&this.debug_info(),this.game_over||this.game_timeout||this.game_pause||this.game_ready||this.game_up?this.CURRENT_ANIMATION_ID=(0,v.MathRandom)():requestAnimationFrame((t=>{this.CURRENT_ANIMATION_ID===e?this.animate(t,e):console.log({animation_id1:this.CURRENT_ANIMATION_ID,animation_id2:e})}))};animate(t,e){this.debug?this.check_fps(0,t,e,this.do_animate):this.do_animate(t,e)}}},906:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.gui=void 0;const s=i(556),a=i(882);class h{ctx;img;img_width;img_height;x;y;width;height;debug;constructor(t){t.debug??=!1,this.debug=t.debug,this.ctx=t.ctx,this.img=t.img,this.img_width=t.img_width,this.img_height=t.img_height,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}clear(){this.ctx.clearRect(this.x-1,this.y-1,this.width+2,this.height+2),this.debug&&this.ctx.strokeRect(this.x-1,this.y-1,this.width+2,this.height+2)}draw(){this.clear(),this.ctx.fillStyle=`rgb(${s.COLOR.red})`,this.ctx.drawImage(this.img,0,0,this.img_width,this.img_height,this.x,this.y,this.width,this.height)}}class r{debug;ctx;x;y;width;height;bg_color;border_color;border_size;radius;constructor(t){t.height??=20,t.border_color??=`rgba(${s.COLOR.dark}, 1)`,t.border_size??=0,t.bg_color??=`rgba(${s.COLOR.light}, 1)`,t.radius??=5,t.debug??=!1,this.debug=t.debug,this.ctx=t.ctx,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.radius=t.radius,this.bg_color=t.bg_color,this.border_color=t.border_color,this.border_size=t.border_size}clear(){this.border_color&&this.border_size?this.ctx.clearRect(this.x-this.border_size,this.y-this.border_size,this.width+2*this.border_size,this.height+2*this.border_size):this.ctx.clearRect(this.x-1,this.y-1,this.width+2,this.height+2),this.debug&&(this.border_color&&this.border_size?this.ctx.strokeRect(this.x-this.border_size,this.y-this.border_size,this.width+2*this.border_size,this.height+2*this.border_size):this.ctx.strokeRect(this.x-1,this.y-1,this.width+2,this.height+2))}draw(){this.clear(),this.ctx.save(),this.ctx.beginPath(),this.border_color&&this.border_size&&(this.ctx.strokeStyle=this.border_color,this.ctx.lineWidth=this.border_size),this.ctx.fillStyle=this.bg_color,this.radius?this.ctx.roundRect(this.x,this.y,this.width,this.height,[this.radius]):this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.fill(),this.border_color&&this.border_size&&this.ctx.stroke(),this.ctx.restore()}}class n{debug;ctx;x;y;text_value;text_align;font_weight;font_family;font_bold;text_color;shadow_color;shadow_blur;constructor(t){t.font_family??="Creepster",t.font_bold??=!1,t.font_weight??=20,t.text_color??=`rgb(${s.COLOR.light})`,t.shadow_color??=`rgb(${s.COLOR.dark})`,t.shadow_blur??=2,t.text_align??="left",t.debug??=!1,this.debug=t.debug,this.ctx=t.ctx,this.x=t.x,this.y=t.y,this.text_value=t.text,this.text_align=t.text_align,this.font_weight=t.font_weight,this.font_family=t.font_family,this.font_bold=t.font_bold,this.text_color=t.text_color,this.shadow_color=t.shadow_color,this.shadow_blur=t.shadow_blur}clear(){(0,a.clear_text)({debug:this.debug,ctx:this.ctx,x:this.x,y:this.y,text:this.text_value,text_align:this.text_align,font_weight:this.font_weight,font_family:this.font_family,font_bold:this.font_bold,shadow_blur:this.shadow_blur})}draw(){this.clear(),(0,a.draw_text)({debug:this.debug,ctx:this.ctx,x:this.x,y:this.y,text:this.text_value,text_align:this.text_align,font_weight:this.font_weight,font_family:this.font_family,font_bold:this.font_bold,text_color:this.text_color,shadow_color:this.shadow_color,shadow_blur:this.shadow_blur})}}e.gui=class{debug;ctx;canvas_width;canvas_height;progress=[];text=[];image=[];box=[];constructor(t){if(t.debug??=!1,this.debug=t.debug,this.ctx=t.ctx,this.canvas_width=t.canvas_width,this.canvas_height=t.canvas_height,this.image.push(new h({ctx:this.ctx,img:(0,s.ASSETIMG)(s.ASSET.ctl.icon_png),img_width:72,img_height:72,x:20,y:30,width:55,height:55,debug:this.debug})),this.image.push(new h({ctx:this.ctx,img:(0,s.ASSETSVG)("life",`rgb(${s.COLOR.red})`),img_width:16,img_height:16,x:this.canvas_width-165,y:30,width:20,height:20,debug:this.debug})),this.image.push(new h({ctx:this.ctx,img:(0,s.ASSETSVG)("lightning",`rgb(${s.COLOR.yellow})`),img_width:16,img_height:16,x:this.canvas_width-165,y:60,width:20,height:20,debug:this.debug})),this.text.push(new n({ctx:this.ctx,x:5,y:this.canvas_height-5,text:"https://github.com/printf83/ts-game",text_align:"left",font_family:"Arial",font_bold:!0,shadow_blur:1,text_color:`rgb(${s.COLOR.light})`,font_weight:15,debug:this.debug})),this.text.push(new n({ctx:this.ctx,x:this.canvas_width-5,y:this.canvas_height-5,text:"https://printf83.github.io/ts-game/",text_align:"right",font_family:"Arial",font_bold:!0,shadow_blur:1,text_color:`rgb(${s.COLOR.light})`,font_weight:15,debug:this.debug})),this.debug){let t=120,e=0;const i=i=>new n({ctx:this.ctx,x:20,y:t+25*e++,shadow_blur:0,text:i,text_color:`rgb(${s.COLOR.yellow})`,font_family:"Arial",font_weight:20,debug:this.debug});this.text.push(i("FPS :")),this.text.push(i("Dust :")),this.text.push(i("Fire :")),this.text.push(i("Explosion :")),this.text.push(i("Enemy :")),this.text.push(i("Score :")),this.text.push(i("Random :"))}this.progress.push(new r({ctx:this.ctx,x:.5*this.canvas_width-.4*this.canvas_width*.5,y:60,width:.4*this.canvas_width,debug:this.debug})),this.progress.push(new r({ctx:this.ctx,x:this.canvas_width-130,y:30,width:100,debug:this.debug})),this.progress.push(new r({ctx:this.ctx,x:this.canvas_width-130,y:60,width:100,debug:this.debug}))}draw(){[...this.text,...this.progress,...this.box,...this.image].forEach((t=>{t.draw()}))}}},489:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.input=void 0;e.input=class{key_filter=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," ","Control","Enter"];debug;last_key;constructor(t){t.debug??=!1,this.debug=t.debug,this.last_key="",window.addEventListener("keydown",(t=>{this.key_filter.indexOf(t.key)>-1?(t.preventDefault(),t.stopPropagation(),"ArrowLeft"===t.key&&(this.last_key="PRESS left"),"ArrowRight"===t.key&&(this.last_key="PRESS right"),"ArrowUp"===t.key&&(this.last_key="PRESS up"),"ArrowDown"===t.key&&(this.last_key="PRESS down")," "===t.key&&(this.last_key="PRESS space"),"Control"===t.key&&(this.last_key="PRESS control"),"Enter"===t.key&&(this.last_key="PRESS enter"),this.debug&&console.log(this.last_key)):this.debug&&console.warn(t.key)})),window.addEventListener("keyup",(t=>{this.key_filter.indexOf(t.key)>-1&&(t.preventDefault(),t.stopPropagation(),"ArrowLeft"===t.key&&(this.last_key="RELEASE left"),"ArrowRight"===t.key&&(this.last_key="RELEASE right"),"ArrowUp"===t.key&&(this.last_key="RELEASE up"),"ArrowDown"===t.key&&(this.last_key="RELEASE down")," "===t.key&&(this.last_key="RELEASE space"),"Control"===t.key&&(this.last_key="RELEASE control"),"Enter"===t.key&&(this.last_key="RELEASE enter"),this.debug&&console.log(this.last_key))}))}}},451:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.layer=void 0;const s=i(882);e.layer=class{ctx;img;img_sprite;x;y;width;height;ratio;canvas_width;canvas_height;x2;speed_modifier;constructor(t){this.img=t.img,this.ctx=t.ctx,this.x=0,this.y=0,this.width=t.img_width,this.height=t.img_height,this.canvas_height=t.canvas_height,this.ratio=this.width/this.height,this.canvas_width=this.canvas_height*this.ratio;const e=new OffscreenCanvas(this.canvas_width,this.canvas_height),i=e.getContext("2d");i&&(i.drawImage(this.img,0,0,this.width,this.height,0,0,this.canvas_width,this.canvas_height),this.img_sprite=e.transferToImageBitmap()),this.speed_modifier=t.speed_modifier,this.x2=this.x+this.width}update(t){this.x-=t*this.speed_modifier,this.x<0-this.canvas_width-1&&(this.x=0),this.x2=this.x+this.canvas_width-t-1}draw(){this.img_sprite&&(this.ctx.drawImage(this.img_sprite,(0,s.MathFloor)(this.x),(0,s.MathFloor)(this.y)),this.ctx.drawImage(this.img_sprite,(0,s.MathFloor)(this.x2),(0,s.MathFloor)(this.y)))}}},217:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.particle=void 0;const s=i(882);e.particle=class{ctx;x;y;speed_x;speed_y;size;mark_delete;constructor(t){t.speed_x??=(0,s.MathRandom)(),t.speed_y??=(0,s.MathRandom)(),t.size??=10*(0,s.MathRandom)()+10,this.ctx=t.ctx,this.x=t.x,this.y=t.y,this.speed_x=t.speed_x,this.speed_y=t.speed_y,this.size=t.size,this.mark_delete=!1}update(){this.x-=this.speed_x,this.y-=this.speed_y,this.size*=.97,this.size<.5&&(this.mark_delete=!0)}set_position(t){this.x-=t.game_speed,this.x<0-this.size&&(this.mark_delete=!0)}}},251:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.player=void 0;const s=i(556),a=i(877),h=i(367),r=i(882);class n extends a.baseAnimation{debug=!1;game;state_list={};current_state;canvas_width;canvas_height;invulnerable;powered;power;speed;life;max_speed;velocity_y;weight;collision_scale=.5;collision_adjust_x=0;collision_adjust_y=0;collision_x;collision_y;img_life;img_life_inactive;img_power;img_power_inactive;img_stopwatch;img_stopwatch_inactive;img_shield;img_shield_inactive;constructor(t){const e=130.75;super({img:(0,s.ASSETIMG)(s.ASSET.player),ctx:t.ctx,x:t.x,y:t.canvas_height-e,width:143.75,height:e,sprite_width:575,sprite_height:523,sprite_length:0}),t.debug??=!1,this.debug=t.debug,this.game=t.game,this.img_life=(0,s.ASSETSVG)("life",`rgb(${s.COLOR.red})`),this.img_power=(0,s.ASSETSVG)("lightning",`rgb(${s.COLOR.yellow})`),this.img_stopwatch=(0,s.ASSETSVG)("stopwatch",`rgb(${s.COLOR.blue})`),this.img_shield=(0,s.ASSETSVG)("shield",`rgb(${s.COLOR.green})`),this.img_life_inactive=(0,s.ASSETSVG)("life",`rgb(${s.COLOR.light})`),this.img_power_inactive=(0,s.ASSETSVG)("lightning",`rgb(${s.COLOR.light})`),this.img_stopwatch_inactive=(0,s.ASSETSVG)("stopwatch",`rgb(${s.COLOR.light})`),this.img_shield_inactive=(0,s.ASSETSVG)("shield",`rgb(${s.COLOR.light})`),this.canvas_width=t.canvas_width,this.canvas_height=t.canvas_height,this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale,this.collision_y=this.y+this.collision_adjust_y+this.height*this.collision_scale,this.velocity_y=0,this.weight=1,this.speed=0,this.life=100,this.max_speed=14,this.power=100,this.powered=!1,this.invulnerable=!1,this.state_list={idle:new h.state_idle(this),jump:new h.state_jump(this),fall:new h.state_fall(this),power_fall:new h.state_power_fall(this),run:new h.state_run(this),dizzy:new h.state_dizzy(this),sit:new h.state_sit(this),roll:new h.state_roll(this),jump_roll:new h.state_jump_roll(this),fall_roll:new h.state_fall_roll(this),bite:new h.state_bite(this),ko:new h.state_ko(this),gethit:new h.state_gethit(this)},this.current_state=this.state_list.idle}update_input(t){this.current_state?.handle_input(t)}is_ground(){return this.y>=this.canvas_height-this.height}is_powered(){return this.powered||this.speed===this.max_speed}set_state=t=>{this.current_state?.exit(),this.current_state=this.state_list[t],this.current_state?.enter()};update(t){this.y+=this.velocity_y,this.is_ground()?this.velocity_y=0:this.velocity_y+=this.weight,this.y>this.canvas_height-this.height&&(this.y=this.canvas_height-this.height),this.power+=.1,this.power>100&&(this.power=100),this.power<0&&(this.power=0),this.current_state?.update(),super.update({delta_time:t.delta_time,onframecomplete:()=>{this.current_state?.animation_end(this)}}),this.collision_x=this.x+this.collision_adjust_x+this.width*this.collision_scale,this.collision_y=this.y+this.collision_adjust_y+this.height*this.collision_scale}draw(){super.draw(),this.power>=100?this.ctx.drawImage(this.img_power,(0,r.MathFloor)(this.x+.5*this.width),(0,r.MathFloor)(this.y+10),16,16):this.ctx.drawImage(this.img_power_inactive,(0,r.MathFloor)(this.x+.5*this.width),(0,r.MathFloor)(this.y+10),16,16),this.life<30?this.ctx.drawImage(this.img_life,(0,r.MathFloor)(this.x+.5*this.width+20),(0,r.MathFloor)(this.y+10),16,16):this.ctx.drawImage(this.img_life_inactive,(0,r.MathFloor)(this.x+.5*this.width+20),(0,r.MathFloor)(this.y+10),16,16),this.game.progress_timer_index<20?this.ctx.drawImage(this.img_stopwatch,(0,r.MathFloor)(this.x+.5*this.width-20),(0,r.MathFloor)(this.y+10),16,16):this.ctx.drawImage(this.img_stopwatch_inactive,(0,r.MathFloor)(this.x+.5*this.width-20),(0,r.MathFloor)(this.y+10),16,16),this.invulnerable||this.is_powered()?this.ctx.drawImage(this.img_shield,(0,r.MathFloor)(this.x+.5*this.width-40),(0,r.MathFloor)(this.y+10),16,16):this.ctx.drawImage(this.img_shield_inactive,(0,r.MathFloor)(this.x+.5*this.width-40),(0,r.MathFloor)(this.y+10),16,16),this.debug&&(this.ctx.save(),this.ctx.strokeStyle=`rgb(${s.COLOR.light})`,this.ctx.beginPath(),this.ctx.arc((0,r.MathFloor)(this.collision_x),(0,r.MathFloor)(this.collision_y),100*this.collision_scale,0,r.MathPI2),this.ctx.stroke(),this.ctx.restore())}}e.player=n},374:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.progress=void 0;const s=i(556),a=i(882);e.progress=class{ctx;x;y;min;max;width;height;value;percent;bar_color;generated_bar_color;bar_x;bar_y;bar_width;bar_max_width;bar_height;radius;padding;constructor(t){t.shadow_color??=`rgb(${s.COLOR.dark})`,t.shadow_blur??=1,t.bg_color??=`rgb(${s.COLOR.light})`,t.bar_color??=`rgb(${s.COLOR.medium})`,t.radius??=4,t.padding??=2,t.min??=0,t.max??=1e3,t.height??=20,t.value??=0,this.ctx=t.ctx,this.x=t.x,this.y=t.y,this.min=t.min,this.max=t.max,this.width=t.width,this.height=t.height,this.value=t.value,this.percent=this.value/this.max,this.radius=t.radius,this.padding=t.padding,this.bar_x=this.x+this.padding,this.bar_y=this.y+this.padding,this.bar_height=this.height-2*this.padding,this.bar_max_width=this.width-2*this.padding,this.bar_width=this.bar_max_width*this.percent,this.bar_color=t.bar_color,this.generated_bar_color=this.gradient_bar_color(this.bar_color,(0,a.MathFloor)(this.bar_x),(0,a.MathFloor)(this.bar_max_width))}update(t,e,i){this.min=e??this.min,this.max=i??this.max,this.value=t,this.value<this.min&&(this.value=this.min),this.value>this.max&&(this.value=this.max),this.percent=this.value/this.max,this.bar_width=(this.width-2*this.padding)*this.percent}clean(){this.ctx.clearRect((0,a.MathFloor)(this.bar_x),(0,a.MathFloor)(this.bar_y),this.bar_max_width,this.bar_height)}draw(){this.clean(),this.ctx.save(),this.radius?(this.ctx.beginPath(),this.ctx.fillStyle=this.generated_bar_color,this.ctx.roundRect((0,a.MathFloor)(this.bar_x),(0,a.MathFloor)(this.bar_y),this.bar_width,this.bar_height,[this.radius]),this.ctx.fill()):(this.ctx.fillStyle=this.generated_bar_color,this.ctx.fillRect((0,a.MathFloor)(this.bar_x),(0,a.MathFloor)(this.bar_y),this.bar_width,this.bar_height)),this.ctx.restore()}gradient_bar_color(t,e,i){if(Array.isArray(t)){if(t.length>=2){const s=100/(t.length-1)/100;let a=this.ctx.createLinearGradient(e,0,i+e,0);return t.forEach(((t,e)=>{a.addColorStop(e*s,t)})),a}return 1===t.length&&t[0]?t[0]:`rgb(${s.COLOR.dark})`}return t}}},461:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.score=void 0;const s=i(556),a=i(882);e.score=class{ctx;img;text;value;x;y;destination_x;destination_y;speed_x;speed_y;mark_delete;timer;constructor(t){this.ctx=t.ctx,this.text=t.text,this.value=t.value,this.x=t.x,this.y=t.y,this.destination_x=t.destination_x,this.destination_y=t.destination_y,this.speed_x=.01*(this.destination_x-this.x),this.speed_y=.01*(this.destination_y-this.y),this.mark_delete=!1,this.timer=100;const e=new OffscreenCanvas(100,50),i=e.getContext("2d");(0,a.draw_text)({text_color:this.value<=0?`rgb(${s.COLOR.red})`:`rgb(${s.COLOR.light})`,ctx:i,x:50,y:25,text:this.text,font_weight:30}),this.img=e.transferToImageBitmap()}update(){this.x+=this.speed_x,this.y+=this.speed_y,this.timer--,this.timer<=0&&(this.mark_delete=!0)}draw(){this.ctx.drawImage(this.img,(0,a.MathFloor)(this.x),(0,a.MathFloor)(this.y))}}},295:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.shadow=void 0;const s=i(556),a=i(877);class h extends a.baseAnimation{element;ground;constructor(t){super({img:(0,s.ASSETIMG)(s.ASSET.shadow),ctx:t.ctx,x:t.element.x-.5*t.element.width,y:t.ground,width:.5*t.element.width,height:.25*t.element.width/574*125,sprite_width:574,sprite_height:125,sprite_length:1}),this.element=t.element,this.ground=t.ground}update(t){this.mark_delete=this.element.mark_delete,this.mark_delete||(super.update(t),this.x=this.element.x+.5*(this.element.width-this.width),this.y=this.ground-.25*this.height)}}e.shadow=h},367:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.state_gethit=e.state_ko=e.state_bite=e.state_fall_roll=e.state_jump_roll=e.state_roll=e.state_sit=e.state_dizzy=e.state_run=e.state_power_fall=e.state_fall=e.state_jump=e.state_idle=e.state=e.state_list=void 0,e.state_list={idle:{frame_y:0,sprite_length:7,animation_repeat:0,collision_adjust_x:0,collision_adjust_y:0},jump:{frame_y:1,sprite_length:7,animation_repeat:0,collision_adjust_x:0,collision_adjust_y:0},fall:{frame_y:2,sprite_length:7,animation_repeat:0,collision_adjust_x:0,collision_adjust_y:0},run:{frame_y:3,sprite_length:8,animation_repeat:0,collision_adjust_x:0,collision_adjust_y:0},dizzy:{frame_y:4,sprite_length:11,animation_repeat:3,collision_adjust_x:0,collision_adjust_y:0},sit:{frame_y:5,sprite_length:5,animation_repeat:0,collision_adjust_x:0,collision_adjust_y:15},roll:{frame_y:6,sprite_length:7,animation_repeat:0,collision_adjust_x:-2,collision_adjust_y:22},jump_roll:{frame_y:6,sprite_length:7,animation_repeat:0,collision_adjust_x:-2,collision_adjust_y:22},fall_roll:{frame_y:6,sprite_length:7,animation_repeat:0,collision_adjust_x:-2,collision_adjust_y:22},power_fall:{frame_y:6,sprite_length:7,animation_repeat:0,collision_adjust_x:-2,collision_adjust_y:22},bite:{frame_y:7,sprite_length:7,animation_repeat:1,collision_adjust_x:15,collision_adjust_y:8},ko:{frame_y:8,sprite_length:12,animation_repeat:1,collision_adjust_x:0,collision_adjust_y:30},gethit:{frame_y:9,sprite_length:4,animation_repeat:1,collision_adjust_x:0,collision_adjust_y:0}};class i{img_sprite;current_state;player;constructor(t,e){this.current_state=t,this.player=e}enter(){e.state_list[this.current_state]&&(this.player.frame_x=0,this.player.img_sprite=[],this.player.animation_repeat_index=0,this.player.collision_adjust_x=e.state_list[this.current_state].collision_adjust_x,this.player.collision_adjust_y=e.state_list[this.current_state].collision_adjust_y,this.player.frame_y=e.state_list[this.current_state].frame_y*this.player.sprite_height,this.player.sprite_length=e.state_list[this.current_state].sprite_length-1,this.player.animation_repeat=e.state_list[this.current_state].animation_repeat,void 0!==e.state_list[this.current_state].img_sprite&&e.state_list[this.current_state].img_sprite.length>0?this.player.img_sprite=e.state_list[this.current_state].img_sprite:e.state_list[this.current_state].img_sprite=this.player.build_sprite())}exit(){}update(){}handle_input(t){}animation_end(t){}}e.state=i;e.state_idle=class extends i{constructor(t){super("idle",t)}enter(){super.enter(),this.player.speed=0}handle_input(t){"PRESS right"===t.last_key&&this.player.set_state("run"),"PRESS up"===t.last_key&&this.player.set_state("jump"),"PRESS down"===t.last_key&&this.player.set_state("sit"),"PRESS space"===t.last_key&&this.player.set_state("bite"),"PRESS control"===t.last_key&&this.player.set_state("roll")}};e.state_jump=class extends i{constructor(t){super("jump",t)}enter(){super.enter(),this.player.is_ground()&&(this.player.weight=1,this.player.velocity_y-=32)}update(){super.update(),this.player.velocity_y>0&&this.player.set_state("fall")}handle_input(t){"PRESS down"===t.last_key&&(this.player.velocity_y=0,this.player.set_state("fall")),"PRESS control"===t.last_key&&this.player.power>10&&this.player.set_state("jump_roll")}};e.state_fall=class extends i{constructor(t){super("fall",t)}enter(){super.enter()}update(){super.update(),this.player.is_ground()&&(this.player.speed>0?this.player.set_state("run"):this.player.set_state("idle"))}handle_input(t){"PRESS control"===t.last_key&&this.player.power>10&&this.player.set_state("fall_roll"),"PRESS down"===t.last_key&&this.player.power>10&&this.player.set_state("power_fall")}};e.state_power_fall=class extends i{constructor(t){super("power_fall",t)}enter(){super.enter(),this.player.weight=20,this.player.speed=this.player.max_speed}exit(){super.exit(),this.player.weight=1,this.player.speed=.5*this.player.max_speed}update(){super.update(),this.player.power--,this.player.is_ground()?this.player.set_state("run"):this.player.power<=0&&this.player.set_state("fall")}handle_input(t){"RELESE down"===t.last_key&&this.player.set_state("fall")}};e.state_run=class extends i{constructor(t){super("run",t)}enter(){super.enter(),this.player.speed=.5*this.player.max_speed}handle_input(t){"PRESS left"===t.last_key&&this.player.set_state("idle"),"PRESS down"===t.last_key&&this.player.set_state("sit"),"PRESS up"===t.last_key&&this.player.set_state("jump"),"PRESS space"===t.last_key&&this.player.set_state("bite"),"PRESS control"===t.last_key&&this.player.power>10&&this.player.set_state("roll")}};e.state_dizzy=class extends i{constructor(t){super("dizzy",t)}enter(){super.enter(),this.player.speed=0,this.player.invulnerable=!0}exit(){this.player.invulnerable=!1}animation_end(t){t.set_state("idle")}};e.state_sit=class extends i{constructor(t){super("sit",t)}enter(){super.enter(),this.player.invulnerable=!0,this.player.speed=0}exit(){this.player.invulnerable=!1}update(){super.update(),this.player.power+=.5}handle_input(t){"RELEASE down"!==t.last_key&&"PRESS up"!==t.last_key&&"PRESS left"!==t.last_key||this.player.set_state("idle"),"PRESS right"===t.last_key&&this.player.set_state("run")}};e.state_roll=class extends i{constructor(t){super("roll",t)}enter(){super.enter(),this.player.speed=this.player.max_speed}update(){super.update(),this.player.power--,this.player.power<=0&&(this.player.power=0,this.player.set_state("run"))}handle_input(t){"RELEASE control"===t.last_key&&this.player.set_state("run")}};e.state_jump_roll=class extends i{constructor(t){super("jump_roll",t)}enter(){super.enter(),this.player.speed=this.player.max_speed}exit(){this.player.speed=.5*this.player.max_speed}update(){super.update(),this.player.power--,this.player.velocity_y>0?this.player.power<=0?this.player.set_state("fall"):this.player.set_state("fall_roll"):this.player.power<=0&&this.player.set_state("jump")}handle_input(t){"RELEASE control"===t.last_key&&(this.player.velocity_y>0?this.player.set_state("fall"):this.player.set_state("jump"))}};e.state_fall_roll=class extends i{constructor(t){super("fall_roll",t)}enter(){super.enter(),this.player.speed=this.player.max_speed}exit(){this.player.speed=.5*this.player.max_speed}update(){super.update(),this.player.is_ground()?this.player.set_state("roll"):(this.player.power--,this.player.power<=0&&this.player.set_state("fall"))}handle_input(t){"RELEASE control"===t.last_key&&this.player.set_state("fall")}};e.state_bite=class extends i{constructor(t){super("bite",t)}enter(){super.enter(),this.player.powered=!0,this.player.invulnerable=!0,this.player.speed=0}exit(){this.player.powered=!1,this.player.invulnerable=!1}animation_end(t){t.set_state("idle")}};e.state_ko=class extends i{constructor(t){super("ko",t)}enter(){super.enter(),this.player.weight=20,this.player.invulnerable=!0,this.player.speed=0}};e.state_gethit=class extends i{constructor(t){super("gethit",t)}enter(){super.enter(),this.player.invulnerable=!0,this.player.speed=0}exit(){this.player.invulnerable=!1}animation_end(t){t.set_state("idle")}}},882:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.draw_text=e.draw_clear_text=e.clear_text=e.measure_text=e.clearArray=e.DPI=e.isFullscreen=e.isTouchDevice=e.getURLParam=e.genUID=e.read_random_index=e.MathRandom=e.MathFloorPosifive=e.MathFloor=e.MathPI2=e.MathPI=void 0;const s=i(556);e.MathPI=Math.PI,e.MathPI2=2*e.MathPI;e.MathFloor=t=>t+(t<0?-1:0)>>0;e.MathFloorPosifive=t=>t>>0;let a=0;const h=Array(32e3).fill(0).map((t=>Math.random()));e.MathRandom=()=>++a>=32e3?h[a=0]:h[a];e.read_random_index=()=>a;e.genUID=()=>Array(3).fill(0).map((t=>(0,e.MathFloor)(255*(0,e.MathRandom)())));e.getURLParam=t=>{const e=t.slice(t.indexOf("?")+1).split("&"),i={};return e.map((t=>{const[e,s]=t.split("=");e&&s&&(i[e]=decodeURIComponent(s))})),i};e.isTouchDevice=()=>"ontouchstart"in window||navigator.maxTouchPoints>0;e.isFullscreen=()=>window.innerHeight===screen.height,e.DPI=window.devicePixelRatio;e.clearArray=t=>{for(;t.length>0;)t.pop()};e.measure_text=t=>{t.font_family??="Creepster",t.font_weight??=20,t.font_bold??=!1,t.text_align??="left",t.ctx.save(),t.ctx.font=`${t.font_weight}px ${t.font_family}`,t.ctx.textAlign=t.text_align;const e=t.ctx.measureText(` ${t.text.toUpperCase()} `);return t.ctx.restore(),{w:e.width,h:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent}};e.clear_text=t=>{t.font_family??="Creepster",t.font_weight??=20,t.font_bold??=!1,t.shadow_blur??=2,t.text_align??="left",t.debug??=!1;const i=(0,e.measure_text)({ctx:t.ctx,text:t.text,font_weight:t.font_weight,font_family:t.font_family,font_bold:t.font_bold,text_align:t.text_align});let s=0,a=0,h=0,r=0;"start"===t.text_align||"left"===t.text_align?(s=t.x,a=t.y-i.h,h=i.w+t.shadow_blur,r=i.h+t.shadow_blur):"end"===t.text_align||"right"===t.text_align?(s=t.x-i.w,a=t.y-i.h,h=i.w+t.shadow_blur,r=i.h+t.shadow_blur):(s=t.x-.5*i.w,a=t.y-i.h,h=i.w+t.shadow_blur,r=i.h+t.shadow_blur);t.ctx.clearRect((0,e.MathFloor)(s-4),(0,e.MathFloor)(a-4),(0,e.MathFloor)(h+8),(0,e.MathFloor)(r+8)),t.debug&&t.ctx.strokeRect((0,e.MathFloor)(s-4),(0,e.MathFloor)(a-4),(0,e.MathFloor)(h+8),(0,e.MathFloor)(r+8))};e.draw_clear_text=t=>{t.font_family??="Creepster",t.font_bold??=!1,t.font_weight??=20,t.text_color??=`rgb(${s.COLOR.light})`,t.shadow_color??=`rgb(${s.COLOR.dark})`,t.shadow_blur??=2,t.text_align??="left",t.debug??=!1,(0,e.clear_text)(t),(0,e.draw_text)(t)};e.draw_text=t=>{t.font_family??="Creepster",t.font_bold??=!1,t.font_weight??=20,t.text_color??=`rgb(${s.COLOR.light})`,t.shadow_color??=`rgb(${s.COLOR.dark})`,t.shadow_blur??=2,t.text_align??="left",t.debug??=!1,t.ctx.save(),t.ctx.textAlign=t.text_align,t.ctx.font=`${t.font_bold?"bold ":""}${t.font_weight}px ${t.font_family}`,t.ctx.fillStyle=t.shadow_color,t.ctx.fillText(t.text,(0,e.MathFloor)(t.x+t.shadow_blur),(0,e.MathFloor)(t.y+t.shadow_blur)),t.ctx.fillStyle=t.text_color,t.ctx.fillText(t.text,(0,e.MathFloor)(t.x),(0,e.MathFloor)(t.y)),t.ctx.restore()}}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var h=e[s]={exports:{}};return t[s](h,h.exports,i),h.exports}(()=>{const t=i(632),e=i(556),s=i(502),a=i(769),h=i(882),r=document.getElementById("gameCanvas"),n=document.getElementById("guiCanvas"),_=document.getElementById("valueCanvas"),o=document.getElementById("controlCanvas"),l=document.getElementById("pointerCanvas"),c=document.getElementById("markerCanvas"),d=document.getElementById("aiCanvas"),g=document.getElementById("loading_text"),m=document.getElementById("loading_counter");let p=0;const w=(t,e,i)=>{t>0?(p+=t,m.innerText=`${(0,h.MathFloor)(p/3470156*100)}% Complete`):e&&i&&(g.innerText=i>1e6?`Download ${(i/1e6).toFixed(2)}Mb : ${e}`:`Download ${(i/1e3).toFixed(2)}Kb : ${e}`)};window.addEventListener("load",(()=>{const{debug:i,useai:g}=(0,h.getURLParam)(document.URL),m="true"===i,p="true"===g;(0,e.LOAD_ALL_ASSET)(w,(()=>{if(r&&n&&_&&o&&l&&c&&d){[r,n,_,o,l,c,d].forEach((t=>{t.width=1300,t.height=700})),m?(c.classList.remove("hide"),l.classList.remove("hide"),d.classList.remove("hide")):(c.classList.add("hide"),l.classList.add("hide"),d.classList.add("hide")),r.addEventListener("game_up",(t=>{const e=t.detail;s.cookie.set("data",JSON.stringify(e))})),r.addEventListener("game_over",(()=>{s.cookie.delete("data")}));const e=new a.game({canvas_game:r,canvas_static:n,canvas_value:_,canvas_control:o,canvas_pointer:l,canvas_mark:c,debug:m});setTimeout((()=>{const i=s.cookie.get("data");i?e.game_start(JSON.parse(i)):m?e.game_start({game_level:10,game_score:0,player_life:100,player_power:100}):e.game_start(),p&&new t.ai({game:e,canvas:d}).start()}),1e3),window.addEventListener("resize",(()=>{e.resize()}))}else console.error("gameCanvas not found")}))}))})()})();